Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='ETTm1_96_96', model='MLPAer_univariate', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.05, head_dropout=0.5, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=7, t_ff=256, c_dropout=0.1, t_dropout=0.2, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_MLPAer_univariate_ETTm1_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2841342
	speed: 0.0390s/iter; left time: 1253.2622s
	iters: 200, epoch: 1 | loss: 0.1067274
	speed: 0.0119s/iter; left time: 380.1843s
	iters: 300, epoch: 1 | loss: 0.1163473
	speed: 0.0123s/iter; left time: 391.6661s
	iters: 400, epoch: 1 | loss: 0.1359149
	speed: 0.0111s/iter; left time: 353.9588s
	iters: 500, epoch: 1 | loss: 0.1326769
	speed: 0.0123s/iter; left time: 391.5173s
	iters: 600, epoch: 1 | loss: 0.1355468
	speed: 0.0111s/iter; left time: 351.6671s
	iters: 700, epoch: 1 | loss: 0.1833775
	speed: 0.0103s/iter; left time: 325.2122s
	iters: 800, epoch: 1 | loss: 0.1286234
	speed: 0.0119s/iter; left time: 373.7284s
	iters: 900, epoch: 1 | loss: 0.1005462
	speed: 0.0124s/iter; left time: 388.0752s
	iters: 1000, epoch: 1 | loss: 0.1328640
	speed: 0.0115s/iter; left time: 360.3146s
Epoch: 1 cost time: 13.12662959098816
Epoch: 1, Steps: 1074 | Train Loss: 0.1206151 Vali Loss: 0.0659542 Test Loss: 0.0340437
Validation loss decreased (inf --> 0.065954).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0582663
	speed: 0.0797s/iter; left time: 2474.9111s
	iters: 200, epoch: 2 | loss: 0.1055223
	speed: 0.0106s/iter; left time: 327.9760s
	iters: 300, epoch: 2 | loss: 0.0729186
	speed: 0.0104s/iter; left time: 322.0315s
	iters: 400, epoch: 2 | loss: 0.0914504
	speed: 0.0101s/iter; left time: 311.8903s
	iters: 500, epoch: 2 | loss: 0.0692429
	speed: 0.0116s/iter; left time: 356.1646s
	iters: 600, epoch: 2 | loss: 0.1006062
	speed: 0.0120s/iter; left time: 366.4602s
	iters: 700, epoch: 2 | loss: 0.1071071
	speed: 0.0121s/iter; left time: 367.8804s
	iters: 800, epoch: 2 | loss: 0.0931568
	speed: 0.0106s/iter; left time: 321.9905s
	iters: 900, epoch: 2 | loss: 0.1432416
	speed: 0.0115s/iter; left time: 348.8022s
	iters: 1000, epoch: 2 | loss: 0.0718583
	speed: 0.0118s/iter; left time: 357.1804s
Epoch: 2 cost time: 12.568318605422974
Epoch: 2, Steps: 1074 | Train Loss: 0.0956981 Vali Loss: 0.0557011 Test Loss: 0.0288481
Validation loss decreased (0.065954 --> 0.055701).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1579988
	speed: 0.0830s/iter; left time: 2486.8129s
	iters: 200, epoch: 3 | loss: 0.0597323
	speed: 0.0122s/iter; left time: 364.5144s
	iters: 300, epoch: 3 | loss: 0.0869919
	speed: 0.0116s/iter; left time: 345.9511s
	iters: 400, epoch: 3 | loss: 0.1248005
	speed: 0.0132s/iter; left time: 390.3678s
	iters: 500, epoch: 3 | loss: 0.0936419
	speed: 0.0126s/iter; left time: 373.8311s
	iters: 600, epoch: 3 | loss: 0.0878423
	speed: 0.0126s/iter; left time: 371.6826s
	iters: 700, epoch: 3 | loss: 0.0767093
	speed: 0.0119s/iter; left time: 350.1209s
	iters: 800, epoch: 3 | loss: 0.0803101
	speed: 0.0126s/iter; left time: 368.5422s
	iters: 900, epoch: 3 | loss: 0.0890017
	speed: 0.0116s/iter; left time: 339.4359s
	iters: 1000, epoch: 3 | loss: 0.1065002
	speed: 0.0114s/iter; left time: 330.3639s
Epoch: 3 cost time: 13.336247205734253
Epoch: 3, Steps: 1074 | Train Loss: 0.0922596 Vali Loss: 0.0547958 Test Loss: 0.0287108
Validation loss decreased (0.055701 --> 0.054796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0852110
	speed: 0.0815s/iter; left time: 2355.9575s
	iters: 200, epoch: 4 | loss: 0.0845840
	speed: 0.0110s/iter; left time: 317.0677s
	iters: 300, epoch: 4 | loss: 0.1395869
	speed: 0.0119s/iter; left time: 342.2271s
	iters: 400, epoch: 4 | loss: 0.0587328
	speed: 0.0131s/iter; left time: 374.3915s
	iters: 500, epoch: 4 | loss: 0.0822232
	speed: 0.0122s/iter; left time: 348.3423s
	iters: 600, epoch: 4 | loss: 0.1104496
	speed: 0.0110s/iter; left time: 311.4789s
	iters: 700, epoch: 4 | loss: 0.0623665
	speed: 0.0117s/iter; left time: 330.6780s
	iters: 800, epoch: 4 | loss: 0.0419227
	speed: 0.0125s/iter; left time: 352.2393s
	iters: 900, epoch: 4 | loss: 0.0951636
	speed: 0.0102s/iter; left time: 287.6982s
	iters: 1000, epoch: 4 | loss: 0.0600490
	speed: 0.0118s/iter; left time: 330.3723s
Epoch: 4 cost time: 13.038881540298462
Epoch: 4, Steps: 1074 | Train Loss: 0.0905284 Vali Loss: 0.0532227 Test Loss: 0.0280160
Validation loss decreased (0.054796 --> 0.053223).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0996000
	speed: 0.0787s/iter; left time: 2189.4775s
	iters: 200, epoch: 5 | loss: 0.0800102
	speed: 0.0105s/iter; left time: 291.1437s
	iters: 300, epoch: 5 | loss: 0.0831038
	speed: 0.0108s/iter; left time: 299.0838s
	iters: 400, epoch: 5 | loss: 0.0917096
	speed: 0.0120s/iter; left time: 330.1576s
	iters: 500, epoch: 5 | loss: 0.0625842
	speed: 0.0115s/iter; left time: 315.1046s
	iters: 600, epoch: 5 | loss: 0.0933303
	speed: 0.0131s/iter; left time: 358.9478s
	iters: 700, epoch: 5 | loss: 0.0580652
	speed: 0.0120s/iter; left time: 326.7244s
	iters: 800, epoch: 5 | loss: 0.0714700
	speed: 0.0117s/iter; left time: 318.6880s
	iters: 900, epoch: 5 | loss: 0.0862513
	speed: 0.0113s/iter; left time: 304.6298s
	iters: 1000, epoch: 5 | loss: 0.0859867
	speed: 0.0121s/iter; left time: 326.3688s
Epoch: 5 cost time: 12.893525123596191
Epoch: 5, Steps: 1074 | Train Loss: 0.0889568 Vali Loss: 0.0523911 Test Loss: 0.0280892
Validation loss decreased (0.053223 --> 0.052391).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0764060
	speed: 0.0803s/iter; left time: 2147.0902s
	iters: 200, epoch: 6 | loss: 0.0940821
	speed: 0.0126s/iter; left time: 335.1206s
	iters: 300, epoch: 6 | loss: 0.0674464
	speed: 0.0110s/iter; left time: 293.3739s
	iters: 400, epoch: 6 | loss: 0.0864177
	speed: 0.0114s/iter; left time: 300.3467s
	iters: 500, epoch: 6 | loss: 0.0590941
	speed: 0.0120s/iter; left time: 317.3979s
	iters: 600, epoch: 6 | loss: 0.1578356
	speed: 0.0106s/iter; left time: 278.0571s
	iters: 700, epoch: 6 | loss: 0.1138393
	speed: 0.0107s/iter; left time: 280.0101s
	iters: 800, epoch: 6 | loss: 0.0986174
	speed: 0.0118s/iter; left time: 306.5841s
	iters: 900, epoch: 6 | loss: 0.0598071
	speed: 0.0121s/iter; left time: 313.1253s
	iters: 1000, epoch: 6 | loss: 0.0939372
	speed: 0.0102s/iter; left time: 264.3422s
Epoch: 6 cost time: 12.539834260940552
Epoch: 6, Steps: 1074 | Train Loss: 0.0880306 Vali Loss: 0.0518636 Test Loss: 0.0279837
Validation loss decreased (0.052391 --> 0.051864).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0464936
	speed: 0.0721s/iter; left time: 1852.3972s
	iters: 200, epoch: 7 | loss: 0.1125583
	speed: 0.0112s/iter; left time: 287.3195s
	iters: 300, epoch: 7 | loss: 0.1715796
	speed: 0.0109s/iter; left time: 277.5290s
	iters: 400, epoch: 7 | loss: 0.0683096
	speed: 0.0111s/iter; left time: 281.2875s
	iters: 500, epoch: 7 | loss: 0.0624157
	speed: 0.0107s/iter; left time: 271.3254s
	iters: 600, epoch: 7 | loss: 0.0869258
	speed: 0.0100s/iter; left time: 252.5255s
	iters: 700, epoch: 7 | loss: 0.0698549
	speed: 0.0106s/iter; left time: 266.8516s
	iters: 800, epoch: 7 | loss: 0.0671902
	speed: 0.0102s/iter; left time: 255.2540s
	iters: 900, epoch: 7 | loss: 0.0737643
	speed: 0.0107s/iter; left time: 266.4774s
	iters: 1000, epoch: 7 | loss: 0.1000470
	speed: 0.0109s/iter; left time: 271.2373s
Epoch: 7 cost time: 11.734215497970581
Epoch: 7, Steps: 1074 | Train Loss: 0.0874025 Vali Loss: 0.0515579 Test Loss: 0.0279244
Validation loss decreased (0.051864 --> 0.051558).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0684936
	speed: 0.0734s/iter; left time: 1806.2588s
	iters: 200, epoch: 8 | loss: 0.1326019
	speed: 0.0103s/iter; left time: 253.0078s
	iters: 300, epoch: 8 | loss: 0.0897548
	speed: 0.0112s/iter; left time: 273.2243s
	iters: 400, epoch: 8 | loss: 0.0487024
	speed: 0.0103s/iter; left time: 250.0354s
	iters: 500, epoch: 8 | loss: 0.1380715
	speed: 0.0108s/iter; left time: 261.0039s
	iters: 600, epoch: 8 | loss: 0.0710975
	speed: 0.0106s/iter; left time: 254.3964s
	iters: 700, epoch: 8 | loss: 0.0910667
	speed: 0.0110s/iter; left time: 263.1471s
	iters: 800, epoch: 8 | loss: 0.0884271
	speed: 0.0107s/iter; left time: 254.7251s
	iters: 900, epoch: 8 | loss: 0.1235452
	speed: 0.0109s/iter; left time: 259.5620s
	iters: 1000, epoch: 8 | loss: 0.0892620
	speed: 0.0105s/iter; left time: 248.5919s
Epoch: 8 cost time: 11.72889232635498
Epoch: 8, Steps: 1074 | Train Loss: 0.0868644 Vali Loss: 0.0516230 Test Loss: 0.0280705
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1025428
	speed: 0.0724s/iter; left time: 1704.2472s
	iters: 200, epoch: 9 | loss: 0.0632970
	speed: 0.0106s/iter; left time: 249.1431s
	iters: 300, epoch: 9 | loss: 0.0934779
	speed: 0.0106s/iter; left time: 248.1824s
	iters: 400, epoch: 9 | loss: 0.0667616
	speed: 0.0112s/iter; left time: 260.7604s
	iters: 500, epoch: 9 | loss: 0.0496418
	speed: 0.0108s/iter; left time: 249.3470s
	iters: 600, epoch: 9 | loss: 0.0790284
	speed: 0.0110s/iter; left time: 252.8119s
	iters: 700, epoch: 9 | loss: 0.1037099
	speed: 0.0110s/iter; left time: 252.5980s
	iters: 800, epoch: 9 | loss: 0.1282448
	speed: 0.0111s/iter; left time: 253.8431s
	iters: 900, epoch: 9 | loss: 0.0856466
	speed: 0.0109s/iter; left time: 247.3821s
	iters: 1000, epoch: 9 | loss: 0.0976347
	speed: 0.0106s/iter; left time: 238.9624s
Epoch: 9 cost time: 11.870705127716064
Epoch: 9, Steps: 1074 | Train Loss: 0.0863523 Vali Loss: 0.0515051 Test Loss: 0.0279467
Validation loss decreased (0.051558 --> 0.051505).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0819624
	speed: 0.0738s/iter; left time: 1656.8420s
	iters: 200, epoch: 10 | loss: 0.0520706
	speed: 0.0101s/iter; left time: 226.7634s
	iters: 300, epoch: 10 | loss: 0.0557646
	speed: 0.0108s/iter; left time: 239.9720s
	iters: 400, epoch: 10 | loss: 0.0670689
	speed: 0.0115s/iter; left time: 255.6593s
	iters: 500, epoch: 10 | loss: 0.1281900
	speed: 0.0104s/iter; left time: 228.4345s
	iters: 600, epoch: 10 | loss: 0.0846736
	speed: 0.0101s/iter; left time: 222.2688s
	iters: 700, epoch: 10 | loss: 0.0598584
	speed: 0.0103s/iter; left time: 225.5263s
	iters: 800, epoch: 10 | loss: 0.0720867
	speed: 0.0104s/iter; left time: 225.6005s
	iters: 900, epoch: 10 | loss: 0.1608725
	speed: 0.0111s/iter; left time: 240.0254s
	iters: 1000, epoch: 10 | loss: 0.1266405
	speed: 0.0104s/iter; left time: 224.6328s
Epoch: 10 cost time: 11.556317806243896
Epoch: 10, Steps: 1074 | Train Loss: 0.0860303 Vali Loss: 0.0514385 Test Loss: 0.0280504
Validation loss decreased (0.051505 --> 0.051439).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800272
	speed: 0.0736s/iter; left time: 1573.4620s
	iters: 200, epoch: 11 | loss: 0.0781750
	speed: 0.0107s/iter; left time: 227.4878s
	iters: 300, epoch: 11 | loss: 0.0837355
	speed: 0.0109s/iter; left time: 230.9854s
	iters: 400, epoch: 11 | loss: 0.0888149
	speed: 0.0097s/iter; left time: 204.6598s
	iters: 500, epoch: 11 | loss: 0.0861865
	speed: 0.0101s/iter; left time: 211.1782s
	iters: 600, epoch: 11 | loss: 0.0648877
	speed: 0.0104s/iter; left time: 216.6382s
	iters: 700, epoch: 11 | loss: 0.0632222
	speed: 0.0110s/iter; left time: 229.4921s
	iters: 800, epoch: 11 | loss: 0.0980045
	speed: 0.0114s/iter; left time: 234.9377s
	iters: 900, epoch: 11 | loss: 0.1136876
	speed: 0.0105s/iter; left time: 215.9805s
	iters: 1000, epoch: 11 | loss: 0.0866917
	speed: 0.0115s/iter; left time: 235.5108s
Epoch: 11 cost time: 11.743613243103027
Epoch: 11, Steps: 1074 | Train Loss: 0.0856225 Vali Loss: 0.0513247 Test Loss: 0.0280568
Validation loss decreased (0.051439 --> 0.051325).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0732027
	speed: 0.0724s/iter; left time: 1470.2070s
	iters: 200, epoch: 12 | loss: 0.0717246
	speed: 0.0104s/iter; left time: 209.5601s
	iters: 300, epoch: 12 | loss: 0.0741635
	speed: 0.0114s/iter; left time: 228.2638s
	iters: 400, epoch: 12 | loss: 0.0623407
	speed: 0.0105s/iter; left time: 209.7634s
	iters: 500, epoch: 12 | loss: 0.0766397
	speed: 0.0108s/iter; left time: 214.8936s
	iters: 600, epoch: 12 | loss: 0.0522010
	speed: 0.0104s/iter; left time: 205.3476s
	iters: 700, epoch: 12 | loss: 0.0900113
	speed: 0.0108s/iter; left time: 213.3427s
	iters: 800, epoch: 12 | loss: 0.0717804
	speed: 0.0100s/iter; left time: 196.7091s
	iters: 900, epoch: 12 | loss: 0.0729022
	speed: 0.0107s/iter; left time: 209.0659s
	iters: 1000, epoch: 12 | loss: 0.0720361
	speed: 0.0101s/iter; left time: 195.2805s
Epoch: 12 cost time: 11.505050420761108
Epoch: 12, Steps: 1074 | Train Loss: 0.0851468 Vali Loss: 0.0511051 Test Loss: 0.0281833
Validation loss decreased (0.051325 --> 0.051105).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0779176
	speed: 0.0727s/iter; left time: 1397.3266s
	iters: 200, epoch: 13 | loss: 0.0807498
	speed: 0.0110s/iter; left time: 210.1855s
	iters: 300, epoch: 13 | loss: 0.0986879
	speed: 0.0105s/iter; left time: 200.2249s
	iters: 400, epoch: 13 | loss: 0.0885603
	speed: 0.0106s/iter; left time: 200.3333s
	iters: 500, epoch: 13 | loss: 0.0594341
	speed: 0.0105s/iter; left time: 198.3049s
	iters: 600, epoch: 13 | loss: 0.0882749
	speed: 0.0105s/iter; left time: 197.3568s
	iters: 700, epoch: 13 | loss: 0.0856352
	speed: 0.0109s/iter; left time: 202.2608s
	iters: 800, epoch: 13 | loss: 0.0998751
	speed: 0.0107s/iter; left time: 197.4541s
	iters: 900, epoch: 13 | loss: 0.0903522
	speed: 0.0102s/iter; left time: 188.9361s
	iters: 1000, epoch: 13 | loss: 0.0946610
	speed: 0.0108s/iter; left time: 197.1197s
Epoch: 13 cost time: 11.589110612869263
Epoch: 13, Steps: 1074 | Train Loss: 0.0849161 Vali Loss: 0.0513112 Test Loss: 0.0282106
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0724713
	speed: 0.0713s/iter; left time: 1295.2400s
	iters: 200, epoch: 14 | loss: 0.1074775
	speed: 0.0102s/iter; left time: 183.3693s
	iters: 300, epoch: 14 | loss: 0.0586694
	speed: 0.0102s/iter; left time: 183.1448s
	iters: 400, epoch: 14 | loss: 0.0529116
	speed: 0.0106s/iter; left time: 188.9600s
	iters: 500, epoch: 14 | loss: 0.0524298
	speed: 0.0104s/iter; left time: 184.3068s
	iters: 600, epoch: 14 | loss: 0.0793244
	speed: 0.0104s/iter; left time: 183.4447s
	iters: 700, epoch: 14 | loss: 0.0816152
	speed: 0.0109s/iter; left time: 191.1278s
	iters: 800, epoch: 14 | loss: 0.0668429
	speed: 0.0100s/iter; left time: 174.8152s
	iters: 900, epoch: 14 | loss: 0.0661693
	speed: 0.0102s/iter; left time: 177.0636s
	iters: 1000, epoch: 14 | loss: 0.1383886
	speed: 0.0106s/iter; left time: 182.2129s
Epoch: 14 cost time: 11.34785771369934
Epoch: 14, Steps: 1074 | Train Loss: 0.0846814 Vali Loss: 0.0513002 Test Loss: 0.0282457
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0771247
	speed: 0.0711s/iter; left time: 1215.4216s
	iters: 200, epoch: 15 | loss: 0.1092829
	speed: 0.0111s/iter; left time: 189.2012s
	iters: 300, epoch: 15 | loss: 0.1237465
	speed: 0.0112s/iter; left time: 188.5442s
	iters: 400, epoch: 15 | loss: 0.0742421
	speed: 0.0110s/iter; left time: 185.2732s
	iters: 500, epoch: 15 | loss: 0.0971916
	speed: 0.0106s/iter; left time: 176.9126s
	iters: 600, epoch: 15 | loss: 0.1043884
	speed: 0.0112s/iter; left time: 184.9764s
	iters: 700, epoch: 15 | loss: 0.0856974
	speed: 0.0109s/iter; left time: 179.7630s
	iters: 800, epoch: 15 | loss: 0.1032708
	speed: 0.0103s/iter; left time: 168.8905s
	iters: 900, epoch: 15 | loss: 0.0952599
	speed: 0.0106s/iter; left time: 173.3705s
	iters: 1000, epoch: 15 | loss: 0.0584820
	speed: 0.0102s/iter; left time: 164.4206s
Epoch: 15 cost time: 11.79001235961914
Epoch: 15, Steps: 1074 | Train Loss: 0.0844631 Vali Loss: 0.0512888 Test Loss: 0.0281251
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_96_MLPAer_univariate_ETTm1_ftMS_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.028183339163661003, mae:0.12493762373924255, rse:0.4915742874145508
