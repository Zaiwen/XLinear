Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='weather_96_336', model='MLPAer_univariate', data='custom', root_path='./dataset/', data_path='weather.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, fc_dropout=0.05, head_dropout=0.4, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=2048, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=21, t_ff=512, c_dropout=0.1, t_dropout=0.2, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.0024458
	speed: 0.0677s/iter; left time: 2307.7094s
	iters: 200, epoch: 1 | loss: 1.0975173
	speed: 0.0489s/iter; left time: 1662.7394s
	iters: 300, epoch: 1 | loss: 3.2968671
	speed: 0.0488s/iter; left time: 1652.2548s
	iters: 400, epoch: 1 | loss: 0.0022078
	speed: 0.0402s/iter; left time: 1357.3841s
	iters: 500, epoch: 1 | loss: 0.0022178
	speed: 0.0458s/iter; left time: 1540.6530s
	iters: 600, epoch: 1 | loss: 0.0025512
	speed: 0.0442s/iter; left time: 1484.6866s
	iters: 700, epoch: 1 | loss: 0.0031965
	speed: 0.0456s/iter; left time: 1527.0701s
	iters: 800, epoch: 1 | loss: 0.0026983
	speed: 0.0455s/iter; left time: 1518.1285s
	iters: 900, epoch: 1 | loss: 1.2427793
	speed: 0.0456s/iter; left time: 1516.5247s
	iters: 1000, epoch: 1 | loss: 1.1041640
	speed: 0.0427s/iter; left time: 1415.4763s
	iters: 1100, epoch: 1 | loss: 0.0034957
	speed: 0.0483s/iter; left time: 1598.5962s
Epoch: 1 cost time: 52.39129161834717
Epoch: 1, Steps: 1139 | Train Loss: 1.1574447 Vali Loss: 0.0041201 Test Loss: 0.0016997
Validation loss decreased (inf --> 0.004120).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3917978
	speed: 0.3745s/iter; left time: 12331.4356s
	iters: 200, epoch: 2 | loss: 2.3350294
	speed: 0.0446s/iter; left time: 1463.7388s
	iters: 300, epoch: 2 | loss: 0.0029631
	speed: 0.0468s/iter; left time: 1530.9577s
	iters: 400, epoch: 2 | loss: 0.0031656
	speed: 0.0486s/iter; left time: 1585.4417s
	iters: 500, epoch: 2 | loss: 0.1102272
	speed: 0.0485s/iter; left time: 1577.7596s
	iters: 600, epoch: 2 | loss: 0.0029330
	speed: 0.0484s/iter; left time: 1570.7770s
	iters: 700, epoch: 2 | loss: 0.0035404
	speed: 0.0397s/iter; left time: 1283.5430s
	iters: 800, epoch: 2 | loss: 3.4337485
	speed: 0.0448s/iter; left time: 1445.0519s
	iters: 900, epoch: 2 | loss: 0.0029515
	speed: 0.0455s/iter; left time: 1461.2083s
	iters: 1000, epoch: 2 | loss: 0.0037441
	speed: 0.0426s/iter; left time: 1363.8393s
	iters: 1100, epoch: 2 | loss: 0.0046310
	speed: 0.0457s/iter; left time: 1459.9238s
Epoch: 2 cost time: 51.75111627578735
Epoch: 2, Steps: 1139 | Train Loss: 1.0298713 Vali Loss: 0.0041091 Test Loss: 0.0016962
Validation loss decreased (0.004120 --> 0.004109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0026621
	speed: 0.3803s/iter; left time: 12090.5178s
	iters: 200, epoch: 3 | loss: 0.0034497
	speed: 0.0449s/iter; left time: 1422.2781s
	iters: 300, epoch: 3 | loss: 0.0029704
	speed: 0.0437s/iter; left time: 1379.3464s
	iters: 400, epoch: 3 | loss: 1.1067080
	speed: 0.0462s/iter; left time: 1453.9490s
	iters: 500, epoch: 3 | loss: 0.0032643
	speed: 0.0395s/iter; left time: 1238.9593s
	iters: 600, epoch: 3 | loss: 0.0030424
	speed: 0.0489s/iter; left time: 1530.9900s
	iters: 700, epoch: 3 | loss: 0.0030439
	speed: 0.0469s/iter; left time: 1464.2494s
	iters: 800, epoch: 3 | loss: 2.3317683
	speed: 0.0490s/iter; left time: 1523.8252s
	iters: 900, epoch: 3 | loss: 0.0812023
	speed: 0.0490s/iter; left time: 1517.9001s
	iters: 1000, epoch: 3 | loss: 5.6253171
	speed: 0.0363s/iter; left time: 1120.7159s
	iters: 1100, epoch: 3 | loss: 0.0037304
	speed: 0.0449s/iter; left time: 1382.2860s
Epoch: 3 cost time: 51.18335270881653
Epoch: 3, Steps: 1139 | Train Loss: 1.0067902 Vali Loss: 0.0042974 Test Loss: 0.0017373
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 1.1042913
	speed: 0.3791s/iter; left time: 11619.7840s
	iters: 200, epoch: 4 | loss: 0.0027368
	speed: 0.0401s/iter; left time: 1224.2764s
	iters: 300, epoch: 4 | loss: 1.9897690
	speed: 0.0442s/iter; left time: 1347.0838s
	iters: 400, epoch: 4 | loss: 2.5087724
	speed: 0.0449s/iter; left time: 1363.2116s
	iters: 500, epoch: 4 | loss: 0.0234264
	speed: 0.0458s/iter; left time: 1386.9115s
	iters: 600, epoch: 4 | loss: 0.0035577
	speed: 0.0445s/iter; left time: 1340.5518s
	iters: 700, epoch: 4 | loss: 0.0029619
	speed: 0.0472s/iter; left time: 1419.9663s
	iters: 800, epoch: 4 | loss: 0.0036408
	speed: 0.0465s/iter; left time: 1393.9011s
	iters: 900, epoch: 4 | loss: 1.1010624
	speed: 0.0486s/iter; left time: 1451.7247s
	iters: 1000, epoch: 4 | loss: 2.2073107
	speed: 0.0473s/iter; left time: 1406.0751s
	iters: 1100, epoch: 4 | loss: 0.0021306
	speed: 0.0495s/iter; left time: 1469.0360s
Epoch: 4 cost time: 52.849425077438354
Epoch: 4, Steps: 1139 | Train Loss: 0.9966205 Vali Loss: 0.0043789 Test Loss: 0.0017617
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 2.3315015
	speed: 0.3337s/iter; left time: 9848.7817s
	iters: 200, epoch: 5 | loss: 1.1052327
	speed: 0.0488s/iter; left time: 1434.6768s
	iters: 300, epoch: 5 | loss: 0.0033501
	speed: 0.0476s/iter; left time: 1395.5832s
	iters: 400, epoch: 5 | loss: 2.6460712
	speed: 0.0508s/iter; left time: 1484.0546s
	iters: 500, epoch: 5 | loss: 3.4343960
	speed: 0.0483s/iter; left time: 1406.1518s
	iters: 600, epoch: 5 | loss: 0.0025313
	speed: 0.0426s/iter; left time: 1237.0542s
	iters: 700, epoch: 5 | loss: 0.7842404
	speed: 0.0453s/iter; left time: 1308.5492s
	iters: 800, epoch: 5 | loss: 2.3315496
	speed: 0.0440s/iter; left time: 1266.8042s
	iters: 900, epoch: 5 | loss: 0.0307950
	speed: 0.0446s/iter; left time: 1281.5284s
	iters: 1000, epoch: 5 | loss: 1.1053146
	speed: 0.0450s/iter; left time: 1286.5630s
	iters: 1100, epoch: 5 | loss: 0.2257790
	speed: 0.0416s/iter; left time: 1187.2670s
Epoch: 5 cost time: 51.91561579704285
Epoch: 5, Steps: 1139 | Train Loss: 0.9941605 Vali Loss: 0.0041773 Test Loss: 0.0017232
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.0016962101217359304, mae:0.030980892479419708, rse:0.9623057246208191
