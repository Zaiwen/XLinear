Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='PJM_168_24', model='MLPAer_h', data='custom', root_path='./dataset/EPF/', data_path='PJM.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=168, label_len=48, pred_len=24, fc_dropout=0.05, head_dropout=0.7, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=14, t_ff=512, c_dropout=0.0, t_dropout=0.0, embed_dropout=0.0, head_type='prediction', usenorm=1, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
>>>>>>>start training : PJM_168_24_MLPAer_h_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36500
val 5219
test 10460
	iters: 100, epoch: 1 | loss: 0.2455617
	speed: 0.0256s/iter; left time: 1751.8202s
	iters: 200, epoch: 1 | loss: 0.7746624
	speed: 0.0075s/iter; left time: 511.7362s
	iters: 300, epoch: 1 | loss: 1.4031079
	speed: 0.0077s/iter; left time: 523.4955s
	iters: 400, epoch: 1 | loss: 0.2078411
	speed: 0.0075s/iter; left time: 510.3240s
	iters: 500, epoch: 1 | loss: 0.4297193
	speed: 0.0074s/iter; left time: 502.7992s
	iters: 600, epoch: 1 | loss: 0.2545969
	speed: 0.0076s/iter; left time: 513.0228s
	iters: 700, epoch: 1 | loss: 0.1180957
	speed: 0.0075s/iter; left time: 510.9276s
	iters: 800, epoch: 1 | loss: 0.2748807
	speed: 0.0075s/iter; left time: 508.4715s
	iters: 900, epoch: 1 | loss: 0.4199646
	speed: 0.0074s/iter; left time: 499.5359s
	iters: 1000, epoch: 1 | loss: 0.4668524
	speed: 0.0076s/iter; left time: 510.3491s
	iters: 1100, epoch: 1 | loss: 0.2508247
	speed: 0.0074s/iter; left time: 499.3513s
	iters: 1200, epoch: 1 | loss: 0.3113317
	speed: 0.0074s/iter; left time: 496.6038s
	iters: 1300, epoch: 1 | loss: 0.2459075
	speed: 0.0076s/iter; left time: 509.3206s
	iters: 1400, epoch: 1 | loss: 0.5897291
	speed: 0.0073s/iter; left time: 487.3021s
	iters: 1500, epoch: 1 | loss: 0.1165687
	speed: 0.0076s/iter; left time: 506.7752s
	iters: 1600, epoch: 1 | loss: 0.1578990
	speed: 0.0075s/iter; left time: 504.1363s
	iters: 1700, epoch: 1 | loss: 0.2347529
	speed: 0.0074s/iter; left time: 496.2180s
	iters: 1800, epoch: 1 | loss: 1.6927384
	speed: 0.0076s/iter; left time: 507.6652s
	iters: 1900, epoch: 1 | loss: 1.6757827
	speed: 0.0075s/iter; left time: 499.2568s
	iters: 2000, epoch: 1 | loss: 0.1781496
	speed: 0.0077s/iter; left time: 514.0090s
	iters: 2100, epoch: 1 | loss: 0.2280688
	speed: 0.0074s/iter; left time: 490.3565s
	iters: 2200, epoch: 1 | loss: 1.6736979
	speed: 0.0076s/iter; left time: 500.7879s
Epoch: 1 cost time: 17.824056148529053
Epoch: 1, Steps: 2281 | Train Loss: 0.8941581 Vali Loss: 0.2144312 Test Loss: 0.2362200
Validation loss decreased (inf --> 0.214431).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3010327
	speed: 0.0614s/iter; left time: 4057.2672s
	iters: 200, epoch: 2 | loss: 0.3360187
	speed: 0.0076s/iter; left time: 501.9760s
	iters: 300, epoch: 2 | loss: 0.7352693
	speed: 0.0076s/iter; left time: 498.0604s
	iters: 400, epoch: 2 | loss: 0.0814573
	speed: 0.0079s/iter; left time: 519.4922s
	iters: 500, epoch: 2 | loss: 0.1464788
	speed: 0.0076s/iter; left time: 499.8877s
	iters: 600, epoch: 2 | loss: 0.0926388
	speed: 0.0079s/iter; left time: 519.3525s
	iters: 700, epoch: 2 | loss: 0.3098301
	speed: 0.0077s/iter; left time: 501.6385s
	iters: 800, epoch: 2 | loss: 0.2451842
	speed: 0.0075s/iter; left time: 492.7105s
	iters: 900, epoch: 2 | loss: 0.0902798
	speed: 0.0077s/iter; left time: 500.1532s
	iters: 1000, epoch: 2 | loss: 0.1481719
	speed: 0.0079s/iter; left time: 511.9523s
	iters: 1100, epoch: 2 | loss: 0.5836074
	speed: 0.0078s/iter; left time: 509.9332s
	iters: 1200, epoch: 2 | loss: 0.1115655
	speed: 0.0074s/iter; left time: 483.6391s
	iters: 1300, epoch: 2 | loss: 0.8844200
	speed: 0.0077s/iter; left time: 499.8951s
	iters: 1400, epoch: 2 | loss: 0.1531324
	speed: 0.0076s/iter; left time: 489.0179s
	iters: 1500, epoch: 2 | loss: 0.1904646
	speed: 0.0075s/iter; left time: 482.1982s
	iters: 1600, epoch: 2 | loss: 0.1077104
	speed: 0.0077s/iter; left time: 498.7283s
	iters: 1700, epoch: 2 | loss: 0.1055009
	speed: 0.0075s/iter; left time: 480.6643s
	iters: 1800, epoch: 2 | loss: 0.5752768
	speed: 0.0075s/iter; left time: 482.5431s
	iters: 1900, epoch: 2 | loss: 0.1184012
	speed: 0.0073s/iter; left time: 471.1863s
	iters: 2000, epoch: 2 | loss: 0.5517027
	speed: 0.0077s/iter; left time: 494.2401s
	iters: 2100, epoch: 2 | loss: 0.1001360
	speed: 0.0072s/iter; left time: 459.8927s
	iters: 2200, epoch: 2 | loss: 0.1285260
	speed: 0.0078s/iter; left time: 501.8680s
Epoch: 2 cost time: 17.653929233551025
Epoch: 2, Steps: 2281 | Train Loss: 0.6355235 Vali Loss: 0.0968395 Test Loss: 0.1257939
Validation loss decreased (0.214431 --> 0.096839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0692310
	speed: 0.0619s/iter; left time: 3945.2705s
	iters: 200, epoch: 3 | loss: 2.3802528
	speed: 0.0080s/iter; left time: 512.3904s
	iters: 300, epoch: 3 | loss: 0.0622604
	speed: 0.0077s/iter; left time: 492.0860s
	iters: 400, epoch: 3 | loss: 0.5018343
	speed: 0.0076s/iter; left time: 481.2027s
	iters: 500, epoch: 3 | loss: 0.1161287
	speed: 0.0076s/iter; left time: 481.8898s
	iters: 600, epoch: 3 | loss: 5.3763404
	speed: 0.0076s/iter; left time: 481.6998s
	iters: 700, epoch: 3 | loss: 0.1574651
	speed: 0.0074s/iter; left time: 467.9518s
	iters: 800, epoch: 3 | loss: 0.0700590
	speed: 0.0077s/iter; left time: 484.0939s
	iters: 900, epoch: 3 | loss: 0.1277621
	speed: 0.0075s/iter; left time: 475.2121s
	iters: 1000, epoch: 3 | loss: 0.2180499
	speed: 0.0076s/iter; left time: 477.7932s
	iters: 1100, epoch: 3 | loss: 0.1940989
	speed: 0.0077s/iter; left time: 481.7181s
	iters: 1200, epoch: 3 | loss: 0.0740405
	speed: 0.0075s/iter; left time: 467.8568s
	iters: 1300, epoch: 3 | loss: 0.1643423
	speed: 0.0075s/iter; left time: 470.8389s
	iters: 1400, epoch: 3 | loss: 0.2557185
	speed: 0.0076s/iter; left time: 474.7976s
	iters: 1500, epoch: 3 | loss: 4.4582119
	speed: 0.0073s/iter; left time: 455.1587s
	iters: 1600, epoch: 3 | loss: 0.0563159
	speed: 0.0074s/iter; left time: 461.1505s
	iters: 1700, epoch: 3 | loss: 1.2014450
	speed: 0.0074s/iter; left time: 462.5787s
	iters: 1800, epoch: 3 | loss: 11.4503727
	speed: 0.0074s/iter; left time: 461.1049s
	iters: 1900, epoch: 3 | loss: 0.2530202
	speed: 0.0075s/iter; left time: 462.6017s
	iters: 2000, epoch: 3 | loss: 0.3190902
	speed: 0.0077s/iter; left time: 474.8016s
	iters: 2100, epoch: 3 | loss: 0.1218166
	speed: 0.0074s/iter; left time: 458.4758s
	iters: 2200, epoch: 3 | loss: 0.2130582
	speed: 0.0078s/iter; left time: 480.0934s
Epoch: 3 cost time: 17.548277854919434
Epoch: 3, Steps: 2281 | Train Loss: 0.4858483 Vali Loss: 0.0827868 Test Loss: 0.1069891
Validation loss decreased (0.096839 --> 0.082787).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1824262
	speed: 0.0614s/iter; left time: 3773.8663s
	iters: 200, epoch: 4 | loss: 0.0539590
	speed: 0.0072s/iter; left time: 441.5793s
	iters: 300, epoch: 4 | loss: 0.1368513
	speed: 0.0070s/iter; left time: 427.3944s
	iters: 400, epoch: 4 | loss: 0.0980515
	speed: 0.0070s/iter; left time: 430.7743s
	iters: 500, epoch: 4 | loss: 0.1085396
	speed: 0.0070s/iter; left time: 430.4532s
	iters: 600, epoch: 4 | loss: 0.0777027
	speed: 0.0071s/iter; left time: 435.6510s
	iters: 700, epoch: 4 | loss: 0.0779143
	speed: 0.0073s/iter; left time: 444.6393s
	iters: 800, epoch: 4 | loss: 0.1038238
	speed: 0.0079s/iter; left time: 478.1757s
	iters: 900, epoch: 4 | loss: 0.1052417
	speed: 0.0080s/iter; left time: 485.8093s
	iters: 1000, epoch: 4 | loss: 0.0770900
	speed: 0.0076s/iter; left time: 462.7273s
	iters: 1100, epoch: 4 | loss: 0.1386862
	speed: 0.0074s/iter; left time: 448.8366s
	iters: 1200, epoch: 4 | loss: 0.0750546
	speed: 0.0074s/iter; left time: 445.1572s
	iters: 1300, epoch: 4 | loss: 0.1675200
	speed: 0.0069s/iter; left time: 418.3017s
	iters: 1400, epoch: 4 | loss: 0.1868274
	speed: 0.0070s/iter; left time: 421.8648s
	iters: 1500, epoch: 4 | loss: 0.0981393
	speed: 0.0071s/iter; left time: 427.4714s
	iters: 1600, epoch: 4 | loss: 0.1200350
	speed: 0.0071s/iter; left time: 427.5677s
	iters: 1700, epoch: 4 | loss: 0.1567873
	speed: 0.0071s/iter; left time: 426.9000s
	iters: 1800, epoch: 4 | loss: 0.2458312
	speed: 0.0073s/iter; left time: 434.7520s
	iters: 1900, epoch: 4 | loss: 0.1111632
	speed: 0.0075s/iter; left time: 444.7448s
	iters: 2000, epoch: 4 | loss: 0.0492822
	speed: 0.0073s/iter; left time: 436.2240s
	iters: 2100, epoch: 4 | loss: 0.0706240
	speed: 0.0074s/iter; left time: 437.2879s
	iters: 2200, epoch: 4 | loss: 0.3523614
	speed: 0.0072s/iter; left time: 425.1179s
Epoch: 4 cost time: 16.851996183395386
Epoch: 4, Steps: 2281 | Train Loss: 0.4267193 Vali Loss: 0.0804739 Test Loss: 0.1090341
Validation loss decreased (0.082787 --> 0.080474).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0602203
	speed: 0.0600s/iter; left time: 3552.9083s
	iters: 200, epoch: 5 | loss: 0.0763218
	speed: 0.0075s/iter; left time: 444.9769s
	iters: 300, epoch: 5 | loss: 0.1382342
	speed: 0.0075s/iter; left time: 443.6563s
	iters: 400, epoch: 5 | loss: 0.0736834
	speed: 0.0081s/iter; left time: 475.2040s
	iters: 500, epoch: 5 | loss: 0.0795593
	speed: 0.0082s/iter; left time: 479.8746s
	iters: 600, epoch: 5 | loss: 0.0889264
	speed: 0.0088s/iter; left time: 514.6930s
	iters: 700, epoch: 5 | loss: 0.0826852
	speed: 0.0083s/iter; left time: 485.7408s
	iters: 800, epoch: 5 | loss: 0.0701854
	speed: 0.0087s/iter; left time: 508.5038s
	iters: 900, epoch: 5 | loss: 0.1291261
	speed: 0.0087s/iter; left time: 509.1099s
	iters: 1000, epoch: 5 | loss: 0.1103085
	speed: 0.0086s/iter; left time: 503.1329s
	iters: 1100, epoch: 5 | loss: 0.5550151
	speed: 0.0077s/iter; left time: 446.8684s
	iters: 1200, epoch: 5 | loss: 0.0570528
	speed: 0.0079s/iter; left time: 456.9258s
	iters: 1300, epoch: 5 | loss: 0.1489064
	speed: 0.0077s/iter; left time: 448.7793s
	iters: 1400, epoch: 5 | loss: 0.0777111
	speed: 0.0075s/iter; left time: 433.8931s
	iters: 1500, epoch: 5 | loss: 0.8695497
	speed: 0.0078s/iter; left time: 449.5191s
	iters: 1600, epoch: 5 | loss: 0.1860369
	speed: 0.0077s/iter; left time: 443.7432s
	iters: 1700, epoch: 5 | loss: 0.1571965
	speed: 0.0077s/iter; left time: 441.0162s
	iters: 1800, epoch: 5 | loss: 0.0498284
	speed: 0.0078s/iter; left time: 448.2454s
	iters: 1900, epoch: 5 | loss: 0.2267758
	speed: 0.0076s/iter; left time: 434.3280s
	iters: 2000, epoch: 5 | loss: 0.0621584
	speed: 0.0076s/iter; left time: 434.6015s
	iters: 2100, epoch: 5 | loss: 0.0770372
	speed: 0.0076s/iter; left time: 436.0320s
	iters: 2200, epoch: 5 | loss: 0.4196053
	speed: 0.0084s/iter; left time: 478.6614s
Epoch: 5 cost time: 18.30913543701172
Epoch: 5, Steps: 2281 | Train Loss: 0.3916414 Vali Loss: 0.0790090 Test Loss: 0.1110583
Validation loss decreased (0.080474 --> 0.079009).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1382720
	speed: 0.0612s/iter; left time: 3483.9980s
	iters: 200, epoch: 6 | loss: 0.1137215
	speed: 0.0076s/iter; left time: 432.0247s
	iters: 300, epoch: 6 | loss: 0.1656079
	speed: 0.0075s/iter; left time: 422.9921s
	iters: 400, epoch: 6 | loss: 0.0522099
	speed: 0.0075s/iter; left time: 423.2499s
	iters: 500, epoch: 6 | loss: 0.0794763
	speed: 0.0074s/iter; left time: 419.7691s
	iters: 600, epoch: 6 | loss: 0.0669777
	speed: 0.0075s/iter; left time: 422.2752s
	iters: 700, epoch: 6 | loss: 0.1573693
	speed: 0.0075s/iter; left time: 424.1071s
	iters: 800, epoch: 6 | loss: 0.0420838
	speed: 0.0074s/iter; left time: 417.5821s
	iters: 900, epoch: 6 | loss: 0.3111537
	speed: 0.0075s/iter; left time: 418.9854s
	iters: 1000, epoch: 6 | loss: 0.0446215
	speed: 0.0076s/iter; left time: 423.0161s
	iters: 1100, epoch: 6 | loss: 0.2337140
	speed: 0.0074s/iter; left time: 414.9574s
	iters: 1200, epoch: 6 | loss: 0.6708413
	speed: 0.0076s/iter; left time: 424.6391s
	iters: 1300, epoch: 6 | loss: 0.3760471
	speed: 0.0074s/iter; left time: 411.8724s
	iters: 1400, epoch: 6 | loss: 0.1146525
	speed: 0.0077s/iter; left time: 430.5364s
	iters: 1500, epoch: 6 | loss: 0.0645351
	speed: 0.0077s/iter; left time: 427.6411s
	iters: 1600, epoch: 6 | loss: 0.0684159
	speed: 0.0078s/iter; left time: 431.8183s
	iters: 1700, epoch: 6 | loss: 0.0662657
	speed: 0.0078s/iter; left time: 430.1439s
	iters: 1800, epoch: 6 | loss: 0.0713608
	speed: 0.0075s/iter; left time: 416.5860s
	iters: 1900, epoch: 6 | loss: 0.0596996
	speed: 0.0076s/iter; left time: 419.8396s
	iters: 2000, epoch: 6 | loss: 0.1629463
	speed: 0.0080s/iter; left time: 437.7959s
	iters: 2100, epoch: 6 | loss: 0.2348965
	speed: 0.0089s/iter; left time: 491.0898s
	iters: 2200, epoch: 6 | loss: 0.0672175
	speed: 0.0077s/iter; left time: 422.5236s
Epoch: 6 cost time: 17.68391489982605
Epoch: 6, Steps: 2281 | Train Loss: 0.3517034 Vali Loss: 0.0780772 Test Loss: 0.1061807
Validation loss decreased (0.079009 --> 0.078077).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1054587
	speed: 0.0606s/iter; left time: 3313.6226s
	iters: 200, epoch: 7 | loss: 0.1390299
	speed: 0.0075s/iter; left time: 407.9293s
	iters: 300, epoch: 7 | loss: 0.1611287
	speed: 0.0075s/iter; left time: 406.5632s
	iters: 400, epoch: 7 | loss: 2.8470390
	speed: 0.0075s/iter; left time: 408.2756s
	iters: 500, epoch: 7 | loss: 0.2701952
	speed: 0.0077s/iter; left time: 415.4082s
	iters: 600, epoch: 7 | loss: 1.0527947
	speed: 0.0078s/iter; left time: 421.4005s
	iters: 700, epoch: 7 | loss: 0.3622675
	speed: 0.0074s/iter; left time: 398.6526s
	iters: 800, epoch: 7 | loss: 0.4053288
	speed: 0.0074s/iter; left time: 397.2157s
	iters: 900, epoch: 7 | loss: 1.1353506
	speed: 0.0073s/iter; left time: 395.2566s
	iters: 1000, epoch: 7 | loss: 0.1637729
	speed: 0.0076s/iter; left time: 410.4148s
	iters: 1100, epoch: 7 | loss: 0.0672941
	speed: 0.0077s/iter; left time: 411.7220s
	iters: 1200, epoch: 7 | loss: 0.1433423
	speed: 0.0077s/iter; left time: 409.8568s
	iters: 1300, epoch: 7 | loss: 0.0621502
	speed: 0.0076s/iter; left time: 406.4328s
	iters: 1400, epoch: 7 | loss: 0.0651649
	speed: 0.0076s/iter; left time: 404.5911s
	iters: 1500, epoch: 7 | loss: 0.1267255
	speed: 0.0075s/iter; left time: 401.5254s
	iters: 1600, epoch: 7 | loss: 0.0861512
	speed: 0.0074s/iter; left time: 391.2757s
	iters: 1700, epoch: 7 | loss: 0.0848436
	speed: 0.0073s/iter; left time: 388.9457s
	iters: 1800, epoch: 7 | loss: 0.0892581
	speed: 0.0075s/iter; left time: 395.0351s
	iters: 1900, epoch: 7 | loss: 0.0503118
	speed: 0.0077s/iter; left time: 407.4562s
	iters: 2000, epoch: 7 | loss: 0.0883417
	speed: 0.0077s/iter; left time: 405.2161s
	iters: 2100, epoch: 7 | loss: 0.4211711
	speed: 0.0075s/iter; left time: 392.8753s
	iters: 2200, epoch: 7 | loss: 0.1017991
	speed: 0.0077s/iter; left time: 405.5059s
Epoch: 7 cost time: 17.417954206466675
Epoch: 7, Steps: 2281 | Train Loss: 0.3325338 Vali Loss: 0.0808438 Test Loss: 0.1147864
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0854327
	speed: 0.0597s/iter; left time: 3127.4302s
	iters: 200, epoch: 8 | loss: 0.1743293
	speed: 0.0079s/iter; left time: 414.1513s
	iters: 300, epoch: 8 | loss: 0.1013204
	speed: 0.0073s/iter; left time: 383.3641s
	iters: 400, epoch: 8 | loss: 0.0748354
	speed: 0.0073s/iter; left time: 379.1827s
	iters: 500, epoch: 8 | loss: 0.0440842
	speed: 0.0076s/iter; left time: 392.3327s
	iters: 600, epoch: 8 | loss: 0.3214575
	speed: 0.0078s/iter; left time: 402.8323s
	iters: 700, epoch: 8 | loss: 0.1304961
	speed: 0.0078s/iter; left time: 404.3175s
	iters: 800, epoch: 8 | loss: 0.0677561
	speed: 0.0077s/iter; left time: 398.7374s
	iters: 900, epoch: 8 | loss: 0.1847021
	speed: 0.0075s/iter; left time: 388.1908s
	iters: 1000, epoch: 8 | loss: 0.1106569
	speed: 0.0074s/iter; left time: 382.3104s
	iters: 1100, epoch: 8 | loss: 0.1850778
	speed: 0.0075s/iter; left time: 384.2046s
	iters: 1200, epoch: 8 | loss: 0.0419061
	speed: 0.0077s/iter; left time: 392.4245s
	iters: 1300, epoch: 8 | loss: 0.0442479
	speed: 0.0076s/iter; left time: 388.2700s
	iters: 1400, epoch: 8 | loss: 0.1843791
	speed: 0.0074s/iter; left time: 378.7785s
	iters: 1500, epoch: 8 | loss: 0.3421563
	speed: 0.0075s/iter; left time: 379.7703s
	iters: 1600, epoch: 8 | loss: 0.2893712
	speed: 0.0075s/iter; left time: 381.8061s
	iters: 1700, epoch: 8 | loss: 0.0632492
	speed: 0.0074s/iter; left time: 375.8428s
	iters: 1800, epoch: 8 | loss: 0.0817106
	speed: 0.0077s/iter; left time: 391.5509s
	iters: 1900, epoch: 8 | loss: 0.2254160
	speed: 0.0074s/iter; left time: 374.6028s
	iters: 2000, epoch: 8 | loss: 0.1432306
	speed: 0.0075s/iter; left time: 379.3318s
	iters: 2100, epoch: 8 | loss: 0.2031033
	speed: 0.0075s/iter; left time: 379.3519s
	iters: 2200, epoch: 8 | loss: 0.8171715
	speed: 0.0076s/iter; left time: 381.1071s
Epoch: 8 cost time: 17.4423611164093
Epoch: 8, Steps: 2281 | Train Loss: 0.3176760 Vali Loss: 0.0761105 Test Loss: 0.1054514
Validation loss decreased (0.078077 --> 0.076110).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0809953
	speed: 0.0606s/iter; left time: 3036.8118s
	iters: 200, epoch: 9 | loss: 0.2628773
	speed: 0.0074s/iter; left time: 371.8945s
	iters: 300, epoch: 9 | loss: 0.0938487
	speed: 0.0074s/iter; left time: 370.3705s
	iters: 400, epoch: 9 | loss: 0.0592996
	speed: 0.0075s/iter; left time: 374.6926s
	iters: 500, epoch: 9 | loss: 0.0857002
	speed: 0.0075s/iter; left time: 374.2835s
	iters: 600, epoch: 9 | loss: 0.7348616
	speed: 0.0074s/iter; left time: 365.6855s
	iters: 700, epoch: 9 | loss: 0.0591811
	speed: 0.0078s/iter; left time: 384.2599s
	iters: 800, epoch: 9 | loss: 0.0664399
	speed: 0.0075s/iter; left time: 370.4575s
	iters: 900, epoch: 9 | loss: 0.2190518
	speed: 0.0077s/iter; left time: 381.6732s
	iters: 1000, epoch: 9 | loss: 0.3359909
	speed: 0.0076s/iter; left time: 373.6957s
	iters: 1100, epoch: 9 | loss: 0.0617812
	speed: 0.0085s/iter; left time: 419.1910s
	iters: 1200, epoch: 9 | loss: 1.3233485
	speed: 0.0087s/iter; left time: 426.4722s
	iters: 1300, epoch: 9 | loss: 0.0747920
	speed: 0.0082s/iter; left time: 399.9414s
	iters: 1400, epoch: 9 | loss: 0.1143849
	speed: 0.0082s/iter; left time: 402.4492s
	iters: 1500, epoch: 9 | loss: 1.0621922
	speed: 0.0074s/iter; left time: 361.2956s
	iters: 1600, epoch: 9 | loss: 0.0375320
	speed: 0.0074s/iter; left time: 359.1808s
	iters: 1700, epoch: 9 | loss: 0.0859362
	speed: 0.0076s/iter; left time: 368.3683s
	iters: 1800, epoch: 9 | loss: 0.1033016
	speed: 0.0074s/iter; left time: 359.4316s
	iters: 1900, epoch: 9 | loss: 0.0511252
	speed: 0.0075s/iter; left time: 361.9670s
	iters: 2000, epoch: 9 | loss: 0.1765844
	speed: 0.0077s/iter; left time: 371.5219s
	iters: 2100, epoch: 9 | loss: 0.1442762
	speed: 0.0075s/iter; left time: 358.2702s
	iters: 2200, epoch: 9 | loss: 0.0701918
	speed: 0.0078s/iter; left time: 372.0313s
Epoch: 9 cost time: 17.80347728729248
Epoch: 9, Steps: 2281 | Train Loss: 0.2996825 Vali Loss: 0.0774247 Test Loss: 0.1098913
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0456686
	speed: 0.0602s/iter; left time: 2880.0137s
	iters: 200, epoch: 10 | loss: 0.0613087
	speed: 0.0074s/iter; left time: 354.9902s
	iters: 300, epoch: 10 | loss: 0.0355821
	speed: 0.0074s/iter; left time: 354.0903s
	iters: 400, epoch: 10 | loss: 0.0655320
	speed: 0.0075s/iter; left time: 358.5412s
	iters: 500, epoch: 10 | loss: 0.2878556
	speed: 0.0075s/iter; left time: 357.5348s
	iters: 600, epoch: 10 | loss: 0.2081181
	speed: 0.0077s/iter; left time: 364.1079s
	iters: 700, epoch: 10 | loss: 0.0712899
	speed: 0.0075s/iter; left time: 353.7945s
	iters: 800, epoch: 10 | loss: 0.0670705
	speed: 0.0078s/iter; left time: 365.6571s
	iters: 900, epoch: 10 | loss: 0.0855104
	speed: 0.0077s/iter; left time: 363.8491s
	iters: 1000, epoch: 10 | loss: 0.1177254
	speed: 0.0077s/iter; left time: 362.7799s
	iters: 1100, epoch: 10 | loss: 0.2979279
	speed: 0.0077s/iter; left time: 358.1695s
	iters: 1200, epoch: 10 | loss: 0.0523408
	speed: 0.0082s/iter; left time: 380.9636s
	iters: 1300, epoch: 10 | loss: 0.0688131
	speed: 0.0075s/iter; left time: 348.0812s
	iters: 1400, epoch: 10 | loss: 0.5060879
	speed: 0.0075s/iter; left time: 348.6649s
	iters: 1500, epoch: 10 | loss: 0.0583574
	speed: 0.0075s/iter; left time: 347.3180s
	iters: 1600, epoch: 10 | loss: 1.0721705
	speed: 0.0078s/iter; left time: 360.9744s
	iters: 1700, epoch: 10 | loss: 0.0677721
	speed: 0.0076s/iter; left time: 350.3691s
	iters: 1800, epoch: 10 | loss: 0.0489857
	speed: 0.0075s/iter; left time: 344.1000s
	iters: 1900, epoch: 10 | loss: 0.0948261
	speed: 0.0075s/iter; left time: 344.9330s
	iters: 2000, epoch: 10 | loss: 0.1305836
	speed: 0.0085s/iter; left time: 389.7748s
	iters: 2100, epoch: 10 | loss: 0.2236632
	speed: 0.0078s/iter; left time: 357.5194s
	iters: 2200, epoch: 10 | loss: 0.2086794
	speed: 0.0075s/iter; left time: 342.1833s
Epoch: 10 cost time: 17.672876834869385
Epoch: 10, Steps: 2281 | Train Loss: 0.2956698 Vali Loss: 0.0757079 Test Loss: 0.1083684
Validation loss decreased (0.076110 --> 0.075708).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0698505
	speed: 0.0608s/iter; left time: 2769.6407s
	iters: 200, epoch: 11 | loss: 0.0671367
	speed: 0.0076s/iter; left time: 343.2426s
	iters: 300, epoch: 11 | loss: 0.1159584
	speed: 0.0075s/iter; left time: 339.4656s
	iters: 400, epoch: 11 | loss: 0.1338723
	speed: 0.0078s/iter; left time: 351.1948s
	iters: 500, epoch: 11 | loss: 0.0839868
	speed: 0.0075s/iter; left time: 340.1885s
	iters: 600, epoch: 11 | loss: 0.0699369
	speed: 0.0076s/iter; left time: 341.5191s
	iters: 700, epoch: 11 | loss: 0.1539049
	speed: 0.0075s/iter; left time: 335.7738s
	iters: 800, epoch: 11 | loss: 0.8755003
	speed: 0.0076s/iter; left time: 339.4998s
	iters: 900, epoch: 11 | loss: 0.0597019
	speed: 0.0075s/iter; left time: 335.5462s
	iters: 1000, epoch: 11 | loss: 0.0379062
	speed: 0.0077s/iter; left time: 343.7928s
	iters: 1100, epoch: 11 | loss: 0.0911688
	speed: 0.0074s/iter; left time: 328.6045s
	iters: 1200, epoch: 11 | loss: 0.0598151
	speed: 0.0073s/iter; left time: 325.4857s
	iters: 1300, epoch: 11 | loss: 0.0406920
	speed: 0.0074s/iter; left time: 328.9215s
	iters: 1400, epoch: 11 | loss: 0.2247286
	speed: 0.0077s/iter; left time: 339.1177s
	iters: 1500, epoch: 11 | loss: 0.0650144
	speed: 0.0077s/iter; left time: 339.1741s
	iters: 1600, epoch: 11 | loss: 0.3297971
	speed: 0.0074s/iter; left time: 327.7614s
	iters: 1700, epoch: 11 | loss: 0.1061134
	speed: 0.0077s/iter; left time: 337.1459s
	iters: 1800, epoch: 11 | loss: 2.4652393
	speed: 0.0077s/iter; left time: 338.6378s
	iters: 1900, epoch: 11 | loss: 1.6638997
	speed: 0.0073s/iter; left time: 319.4235s
	iters: 2000, epoch: 11 | loss: 0.2166713
	speed: 0.0074s/iter; left time: 323.3030s
	iters: 2100, epoch: 11 | loss: 0.0605765
	speed: 0.0073s/iter; left time: 319.7468s
	iters: 2200, epoch: 11 | loss: 0.0405180
	speed: 0.0072s/iter; left time: 314.7326s
Epoch: 11 cost time: 17.43412160873413
Epoch: 11, Steps: 2281 | Train Loss: 0.2826638 Vali Loss: 0.0745947 Test Loss: 0.1069190
Validation loss decreased (0.075708 --> 0.074595).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0579765
	speed: 0.0603s/iter; left time: 2608.9193s
	iters: 200, epoch: 12 | loss: 0.1817024
	speed: 0.0075s/iter; left time: 325.1253s
	iters: 300, epoch: 12 | loss: 0.0662244
	speed: 0.0077s/iter; left time: 332.4781s
	iters: 400, epoch: 12 | loss: 0.0589054
	speed: 0.0075s/iter; left time: 323.9742s
	iters: 500, epoch: 12 | loss: 1.5476717
	speed: 0.0076s/iter; left time: 324.0040s
	iters: 600, epoch: 12 | loss: 0.0576313
	speed: 0.0076s/iter; left time: 323.2106s
	iters: 700, epoch: 12 | loss: 0.0650880
	speed: 0.0074s/iter; left time: 316.3301s
	iters: 800, epoch: 12 | loss: 0.0542408
	speed: 0.0075s/iter; left time: 317.1952s
	iters: 900, epoch: 12 | loss: 0.0987736
	speed: 0.0076s/iter; left time: 320.4432s
	iters: 1000, epoch: 12 | loss: 0.1876381
	speed: 0.0078s/iter; left time: 328.4092s
	iters: 1100, epoch: 12 | loss: 0.1472218
	speed: 0.0073s/iter; left time: 308.9363s
	iters: 1200, epoch: 12 | loss: 0.0396959
	speed: 0.0074s/iter; left time: 310.5033s
	iters: 1300, epoch: 12 | loss: 0.0477673
	speed: 0.0075s/iter; left time: 316.9245s
	iters: 1400, epoch: 12 | loss: 0.3595403
	speed: 0.0076s/iter; left time: 318.9878s
	iters: 1500, epoch: 12 | loss: 0.1046141
	speed: 0.0074s/iter; left time: 311.0239s
	iters: 1600, epoch: 12 | loss: 0.2492123
	speed: 0.0075s/iter; left time: 312.1531s
	iters: 1700, epoch: 12 | loss: 0.0696451
	speed: 0.0074s/iter; left time: 306.9586s
	iters: 1800, epoch: 12 | loss: 0.8492924
	speed: 0.0074s/iter; left time: 306.5482s
	iters: 1900, epoch: 12 | loss: 0.0716761
	speed: 0.0074s/iter; left time: 305.8804s
	iters: 2000, epoch: 12 | loss: 0.0585067
	speed: 0.0074s/iter; left time: 306.8167s
	iters: 2100, epoch: 12 | loss: 0.1351475
	speed: 0.0074s/iter; left time: 305.9809s
	iters: 2200, epoch: 12 | loss: 0.6454034
	speed: 0.0073s/iter; left time: 301.6647s
Epoch: 12 cost time: 17.271715879440308
Epoch: 12, Steps: 2281 | Train Loss: 0.2716445 Vali Loss: 0.0753181 Test Loss: 0.1061775
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1855526
	speed: 0.0592s/iter; left time: 2423.2949s
	iters: 200, epoch: 13 | loss: 0.0767548
	speed: 0.0079s/iter; left time: 321.6935s
	iters: 300, epoch: 13 | loss: 0.1222677
	speed: 0.0078s/iter; left time: 319.1395s
	iters: 400, epoch: 13 | loss: 0.0598184
	speed: 0.0078s/iter; left time: 316.8946s
	iters: 500, epoch: 13 | loss: 0.2926176
	speed: 0.0078s/iter; left time: 314.4321s
	iters: 600, epoch: 13 | loss: 0.0603955
	speed: 0.0078s/iter; left time: 313.7306s
	iters: 700, epoch: 13 | loss: 0.0775496
	speed: 0.0075s/iter; left time: 303.3944s
	iters: 800, epoch: 13 | loss: 0.0911084
	speed: 0.0077s/iter; left time: 311.0955s
	iters: 900, epoch: 13 | loss: 0.1243583
	speed: 0.0086s/iter; left time: 346.4957s
	iters: 1000, epoch: 13 | loss: 0.0702397
	speed: 0.0087s/iter; left time: 348.8303s
	iters: 1100, epoch: 13 | loss: 0.0904750
	speed: 0.0077s/iter; left time: 308.7372s
	iters: 1200, epoch: 13 | loss: 0.0852057
	speed: 0.0077s/iter; left time: 305.2822s
	iters: 1300, epoch: 13 | loss: 0.0676552
	speed: 0.0077s/iter; left time: 307.4761s
	iters: 1400, epoch: 13 | loss: 0.0339149
	speed: 0.0075s/iter; left time: 295.6288s
	iters: 1500, epoch: 13 | loss: 0.0601311
	speed: 0.0076s/iter; left time: 302.3454s
	iters: 1600, epoch: 13 | loss: 0.1016778
	speed: 0.0075s/iter; left time: 297.1576s
	iters: 1700, epoch: 13 | loss: 0.0494876
	speed: 0.0075s/iter; left time: 295.5967s
	iters: 1800, epoch: 13 | loss: 0.1393235
	speed: 0.0075s/iter; left time: 293.8122s
	iters: 1900, epoch: 13 | loss: 0.0423627
	speed: 0.0076s/iter; left time: 296.3115s
	iters: 2000, epoch: 13 | loss: 0.2427876
	speed: 0.0075s/iter; left time: 292.0327s
	iters: 2100, epoch: 13 | loss: 0.0706716
	speed: 0.0078s/iter; left time: 302.4795s
	iters: 2200, epoch: 13 | loss: 0.0775981
	speed: 0.0076s/iter; left time: 294.1515s
Epoch: 13 cost time: 17.8829185962677
Epoch: 13, Steps: 2281 | Train Loss: 0.2642893 Vali Loss: 0.0733577 Test Loss: 0.1017116
Validation loss decreased (0.074595 --> 0.073358).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2606798
	speed: 0.0613s/iter; left time: 2372.4078s
	iters: 200, epoch: 14 | loss: 0.1496569
	speed: 0.0072s/iter; left time: 277.4258s
	iters: 300, epoch: 14 | loss: 0.2988582
	speed: 0.0075s/iter; left time: 287.4404s
	iters: 400, epoch: 14 | loss: 0.0593875
	speed: 0.0073s/iter; left time: 279.6665s
	iters: 500, epoch: 14 | loss: 0.0542747
	speed: 0.0073s/iter; left time: 278.7150s
	iters: 600, epoch: 14 | loss: 0.1151049
	speed: 0.0075s/iter; left time: 286.7985s
	iters: 700, epoch: 14 | loss: 0.1022002
	speed: 0.0073s/iter; left time: 278.2890s
	iters: 800, epoch: 14 | loss: 0.3073676
	speed: 0.0076s/iter; left time: 287.4350s
	iters: 900, epoch: 14 | loss: 0.2020192
	speed: 0.0075s/iter; left time: 285.2263s
	iters: 1000, epoch: 14 | loss: 0.0559189
	speed: 0.0076s/iter; left time: 287.0150s
	iters: 1100, epoch: 14 | loss: 0.3222502
	speed: 0.0076s/iter; left time: 284.7578s
	iters: 1200, epoch: 14 | loss: 0.0620642
	speed: 0.0076s/iter; left time: 285.6242s
	iters: 1300, epoch: 14 | loss: 0.0701974
	speed: 0.0076s/iter; left time: 285.7080s
	iters: 1400, epoch: 14 | loss: 0.0527672
	speed: 0.0076s/iter; left time: 282.6241s
	iters: 1500, epoch: 14 | loss: 0.0680613
	speed: 0.0079s/iter; left time: 293.9575s
	iters: 1600, epoch: 14 | loss: 0.3338278
	speed: 0.0076s/iter; left time: 281.8520s
	iters: 1700, epoch: 14 | loss: 2.0974970
	speed: 0.0076s/iter; left time: 280.5242s
	iters: 1800, epoch: 14 | loss: 0.0790723
	speed: 0.0075s/iter; left time: 275.7137s
	iters: 1900, epoch: 14 | loss: 0.0550164
	speed: 0.0078s/iter; left time: 286.3935s
	iters: 2000, epoch: 14 | loss: 0.0854108
	speed: 0.0076s/iter; left time: 280.5742s
	iters: 2100, epoch: 14 | loss: 0.1423935
	speed: 0.0073s/iter; left time: 268.9883s
	iters: 2200, epoch: 14 | loss: 0.0378343
	speed: 0.0076s/iter; left time: 279.4553s
Epoch: 14 cost time: 17.441808462142944
Epoch: 14, Steps: 2281 | Train Loss: 0.2591338 Vali Loss: 0.0752256 Test Loss: 0.1069505
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4441539
	speed: 0.0604s/iter; left time: 2198.4022s
	iters: 200, epoch: 15 | loss: 0.0446673
	speed: 0.0083s/iter; left time: 300.6835s
	iters: 300, epoch: 15 | loss: 0.0659206
	speed: 0.0076s/iter; left time: 275.3028s
	iters: 400, epoch: 15 | loss: 0.1445810
	speed: 0.0077s/iter; left time: 278.6066s
	iters: 500, epoch: 15 | loss: 0.0603538
	speed: 0.0076s/iter; left time: 272.9134s
	iters: 600, epoch: 15 | loss: 0.1338686
	speed: 0.0077s/iter; left time: 277.1280s
	iters: 700, epoch: 15 | loss: 0.0656000
	speed: 0.0075s/iter; left time: 269.6066s
	iters: 800, epoch: 15 | loss: 0.1729257
	speed: 0.0081s/iter; left time: 289.8528s
	iters: 900, epoch: 15 | loss: 0.0729330
	speed: 0.0081s/iter; left time: 289.0381s
	iters: 1000, epoch: 15 | loss: 0.2162551
	speed: 0.0075s/iter; left time: 265.0570s
	iters: 1100, epoch: 15 | loss: 0.3191445
	speed: 0.0077s/iter; left time: 274.2615s
	iters: 1200, epoch: 15 | loss: 0.2415611
	speed: 0.0070s/iter; left time: 245.8924s
	iters: 1300, epoch: 15 | loss: 0.0398909
	speed: 0.0069s/iter; left time: 243.8351s
	iters: 1400, epoch: 15 | loss: 0.0406456
	speed: 0.0068s/iter; left time: 239.1367s
	iters: 1500, epoch: 15 | loss: 0.0428790
	speed: 0.0073s/iter; left time: 257.0610s
	iters: 1600, epoch: 15 | loss: 0.0907450
	speed: 0.0074s/iter; left time: 257.2521s
	iters: 1700, epoch: 15 | loss: 0.0416900
	speed: 0.0073s/iter; left time: 253.3078s
	iters: 1800, epoch: 15 | loss: 0.2474256
	speed: 0.0079s/iter; left time: 272.6580s
	iters: 1900, epoch: 15 | loss: 0.0661005
	speed: 0.0079s/iter; left time: 271.8162s
	iters: 2000, epoch: 15 | loss: 0.0438022
	speed: 0.0076s/iter; left time: 261.3699s
	iters: 2100, epoch: 15 | loss: 0.0986391
	speed: 0.0078s/iter; left time: 268.0333s
	iters: 2200, epoch: 15 | loss: 2.8413293
	speed: 0.0076s/iter; left time: 259.9467s
Epoch: 15 cost time: 17.524351835250854
Epoch: 15, Steps: 2281 | Train Loss: 0.2508087 Vali Loss: 0.0750432 Test Loss: 0.1042488
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.9565119
	speed: 0.0597s/iter; left time: 2037.3126s
	iters: 200, epoch: 16 | loss: 0.0765420
	speed: 0.0076s/iter; left time: 259.7685s
	iters: 300, epoch: 16 | loss: 0.2749904
	speed: 0.0075s/iter; left time: 252.6981s
	iters: 400, epoch: 16 | loss: 0.1479515
	speed: 0.0076s/iter; left time: 255.4428s
	iters: 500, epoch: 16 | loss: 0.0533217
	speed: 0.0076s/iter; left time: 257.3785s
	iters: 600, epoch: 16 | loss: 0.2378560
	speed: 0.0074s/iter; left time: 249.8439s
	iters: 700, epoch: 16 | loss: 0.2993308
	speed: 0.0077s/iter; left time: 256.8520s
	iters: 800, epoch: 16 | loss: 0.0551860
	speed: 0.0077s/iter; left time: 257.1177s
	iters: 900, epoch: 16 | loss: 0.1090955
	speed: 0.0074s/iter; left time: 245.5106s
	iters: 1000, epoch: 16 | loss: 0.0539811
	speed: 0.0076s/iter; left time: 250.8310s
	iters: 1100, epoch: 16 | loss: 0.0631232
	speed: 0.0076s/iter; left time: 251.7374s
	iters: 1200, epoch: 16 | loss: 0.0751756
	speed: 0.0074s/iter; left time: 245.8436s
	iters: 1300, epoch: 16 | loss: 0.0378527
	speed: 0.0079s/iter; left time: 258.9499s
	iters: 1400, epoch: 16 | loss: 0.0467283
	speed: 0.0077s/iter; left time: 253.0632s
	iters: 1500, epoch: 16 | loss: 0.0719295
	speed: 0.0076s/iter; left time: 247.9954s
	iters: 1600, epoch: 16 | loss: 0.4376765
	speed: 0.0076s/iter; left time: 247.4576s
	iters: 1700, epoch: 16 | loss: 0.0366974
	speed: 0.0074s/iter; left time: 242.1609s
	iters: 1800, epoch: 16 | loss: 0.0466578
	speed: 0.0075s/iter; left time: 244.2648s
	iters: 1900, epoch: 16 | loss: 0.0647933
	speed: 0.0074s/iter; left time: 239.9270s
	iters: 2000, epoch: 16 | loss: 0.0423614
	speed: 0.0076s/iter; left time: 244.6796s
	iters: 2100, epoch: 16 | loss: 0.1002608
	speed: 0.0075s/iter; left time: 239.5328s
	iters: 2200, epoch: 16 | loss: 0.1044967
	speed: 0.0077s/iter; left time: 245.4086s
Epoch: 16 cost time: 17.441136360168457
Epoch: 16, Steps: 2281 | Train Loss: 0.2449312 Vali Loss: 0.0745073 Test Loss: 0.1039431
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : PJM_168_24_MLPAer_h_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10460
mse:0.10171156376600266, mae:0.2072315663099289, rse:0.5857179760932922
