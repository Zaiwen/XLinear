Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='electricity_96_336', model='MLPAer_univariate', data='custom', root_path='./dataset/', data_path='electricity.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, fc_dropout=0.05, head_dropout=0.6, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=2048, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=2, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=24, t_ff=512, c_dropout=0.1, t_dropout=0.3, embed_dropout=0.3, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.7434162
	speed: 0.0741s/iter; left time: 1239.2081s
	iters: 200, epoch: 1 | loss: 0.7046527
	speed: 0.0579s/iter; left time: 962.2642s
	iters: 300, epoch: 1 | loss: 0.7016741
	speed: 0.0624s/iter; left time: 1031.0612s
	iters: 400, epoch: 1 | loss: 0.7201267
	speed: 0.0635s/iter; left time: 1043.7604s
	iters: 500, epoch: 1 | loss: 0.6603537
	speed: 0.0621s/iter; left time: 1014.2128s
Epoch: 1 cost time: 33.773242712020874
Epoch: 1, Steps: 561 | Train Loss: 0.6903910 Vali Loss: 0.4386801 Test Loss: 0.6207823
Validation loss decreased (inf --> 0.438680).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4508067
	speed: 0.3428s/iter; left time: 5543.7973s
	iters: 200, epoch: 2 | loss: 0.4024120
	speed: 0.0631s/iter; left time: 1013.7029s
	iters: 300, epoch: 2 | loss: 0.2997050
	speed: 0.0643s/iter; left time: 1026.2291s
	iters: 400, epoch: 2 | loss: 0.2781137
	speed: 0.0655s/iter; left time: 1039.5501s
	iters: 500, epoch: 2 | loss: 0.3021512
	speed: 0.0641s/iter; left time: 1010.7102s
Epoch: 2 cost time: 35.874457359313965
Epoch: 2, Steps: 561 | Train Loss: 0.3937972 Vali Loss: 0.2828726 Test Loss: 0.3936594
Validation loss decreased (0.438680 --> 0.282873).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3096510
	speed: 0.3447s/iter; left time: 5380.4386s
	iters: 200, epoch: 3 | loss: 0.2967117
	speed: 0.0621s/iter; left time: 962.4576s
	iters: 300, epoch: 3 | loss: 0.4551796
	speed: 0.0621s/iter; left time: 957.6590s
	iters: 400, epoch: 3 | loss: 0.3376963
	speed: 0.0616s/iter; left time: 943.7977s
	iters: 500, epoch: 3 | loss: 0.4003861
	speed: 0.0620s/iter; left time: 943.5013s
Epoch: 3 cost time: 35.094587326049805
Epoch: 3, Steps: 561 | Train Loss: 0.3175054 Vali Loss: 0.2728599 Test Loss: 0.3794165
Validation loss decreased (0.282873 --> 0.272860).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3144368
	speed: 0.3503s/iter; left time: 5271.6415s
	iters: 200, epoch: 4 | loss: 0.3441916
	speed: 0.0608s/iter; left time: 908.1989s
	iters: 300, epoch: 4 | loss: 0.3393338
	speed: 0.0616s/iter; left time: 914.7121s
	iters: 400, epoch: 4 | loss: 0.2838920
	speed: 0.0628s/iter; left time: 925.9055s
	iters: 500, epoch: 4 | loss: 0.2962133
	speed: 0.0620s/iter; left time: 908.5163s
Epoch: 4 cost time: 35.30880880355835
Epoch: 4, Steps: 561 | Train Loss: 0.2898190 Vali Loss: 0.2704313 Test Loss: 0.3733758
Validation loss decreased (0.272860 --> 0.270431).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2658442
	speed: 0.3452s/iter; left time: 5001.3075s
	iters: 200, epoch: 5 | loss: 0.2725131
	speed: 0.0640s/iter; left time: 920.3105s
	iters: 300, epoch: 5 | loss: 0.2455127
	speed: 0.0634s/iter; left time: 905.5549s
	iters: 400, epoch: 5 | loss: 0.2361009
	speed: 0.0645s/iter; left time: 914.7999s
	iters: 500, epoch: 5 | loss: 0.2027291
	speed: 0.0660s/iter; left time: 930.3519s
Epoch: 5 cost time: 36.14760732650757
Epoch: 5, Steps: 561 | Train Loss: 0.2738925 Vali Loss: 0.2617550 Test Loss: 0.3678886
Validation loss decreased (0.270431 --> 0.261755).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2009999
	speed: 0.3466s/iter; left time: 4827.2468s
	iters: 200, epoch: 6 | loss: 0.2569227
	speed: 0.0626s/iter; left time: 866.1259s
	iters: 300, epoch: 6 | loss: 0.2553434
	speed: 0.0627s/iter; left time: 860.0244s
	iters: 400, epoch: 6 | loss: 0.2325979
	speed: 0.0626s/iter; left time: 853.2623s
	iters: 500, epoch: 6 | loss: 0.2418938
	speed: 0.0626s/iter; left time: 846.8581s
Epoch: 6 cost time: 35.32892084121704
Epoch: 6, Steps: 561 | Train Loss: 0.2627509 Vali Loss: 0.2552001 Test Loss: 0.3608626
Validation loss decreased (0.261755 --> 0.255200).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2615317
	speed: 0.3485s/iter; left time: 4658.3081s
	iters: 200, epoch: 7 | loss: 0.2900630
	speed: 0.0607s/iter; left time: 804.6430s
	iters: 300, epoch: 7 | loss: 0.3457887
	speed: 0.0609s/iter; left time: 801.1430s
	iters: 400, epoch: 7 | loss: 0.1942058
	speed: 0.0572s/iter; left time: 747.4810s
	iters: 500, epoch: 7 | loss: 0.2734224
	speed: 0.0448s/iter; left time: 581.0988s
Epoch: 7 cost time: 31.205247163772583
Epoch: 7, Steps: 561 | Train Loss: 0.2546229 Vali Loss: 0.2452154 Test Loss: 0.3531213
Validation loss decreased (0.255200 --> 0.245215).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2837306
	speed: 0.1825s/iter; left time: 2336.1688s
	iters: 200, epoch: 8 | loss: 0.2689728
	speed: 0.0454s/iter; left time: 576.1765s
	iters: 300, epoch: 8 | loss: 0.2508616
	speed: 0.0447s/iter; left time: 563.9589s
	iters: 400, epoch: 8 | loss: 0.2635459
	speed: 0.0445s/iter; left time: 556.2773s
	iters: 500, epoch: 8 | loss: 0.2040759
	speed: 0.0447s/iter; left time: 554.7298s
Epoch: 8 cost time: 25.01823353767395
Epoch: 8, Steps: 561 | Train Loss: 0.2466409 Vali Loss: 0.2578003 Test Loss: 0.3671078
EarlyStopping counter: 1 out of 2
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2548596
	speed: 0.1764s/iter; left time: 2160.0098s
	iters: 200, epoch: 9 | loss: 0.2943746
	speed: 0.0442s/iter; left time: 537.0504s
	iters: 300, epoch: 9 | loss: 0.2767154
	speed: 0.0447s/iter; left time: 538.3169s
	iters: 400, epoch: 9 | loss: 0.2514442
	speed: 0.0449s/iter; left time: 535.6692s
	iters: 500, epoch: 9 | loss: 0.2729276
	speed: 0.0445s/iter; left time: 526.8115s
Epoch: 9 cost time: 24.75340700149536
Epoch: 9, Steps: 561 | Train Loss: 0.2395318 Vali Loss: 0.2531200 Test Loss: 0.3643424
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>testing : electricity_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.3531211018562317, mae:0.41865304112434387, rse:0.5775977969169617
