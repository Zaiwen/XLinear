Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='traffic_96_96', model='MLPAer_univariate', data='custom', root_path='./dataset/', data_path='traffic.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.05, head_dropout=0.7, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=2048, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=16, patience=2, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=32, t_ff=400, c_dropout=0.1, t_dropout=0.1, embed_dropout=0.1, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_96_MLPAer_univariate_custom_ftMS_sl96_ll48_pl96_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.8768982
	speed: 0.0550s/iter; left time: 1241.1078s
	iters: 200, epoch: 1 | loss: 0.7132289
	speed: 0.0337s/iter; left time: 756.5606s
	iters: 300, epoch: 1 | loss: 0.5161380
	speed: 0.0339s/iter; left time: 756.6614s
	iters: 400, epoch: 1 | loss: 0.3983071
	speed: 0.0337s/iter; left time: 749.2321s
	iters: 500, epoch: 1 | loss: 0.3305963
	speed: 0.0337s/iter; left time: 746.9068s
	iters: 600, epoch: 1 | loss: 0.3148859
	speed: 0.0336s/iter; left time: 740.8769s
	iters: 700, epoch: 1 | loss: 0.2479288
	speed: 0.0334s/iter; left time: 734.2494s
Epoch: 1 cost time: 25.998067140579224
Epoch: 1, Steps: 755 | Train Loss: 0.5095579 Vali Loss: 0.2507058 Test Loss: 0.3570789
Validation loss decreased (inf --> 0.250706).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1911308
	speed: 0.1766s/iter; left time: 3850.1118s
	iters: 200, epoch: 2 | loss: 0.1783164
	speed: 0.0338s/iter; left time: 733.7647s
	iters: 300, epoch: 2 | loss: 0.1213437
	speed: 0.0336s/iter; left time: 726.5784s
	iters: 400, epoch: 2 | loss: 0.1484637
	speed: 0.0337s/iter; left time: 724.8866s
	iters: 500, epoch: 2 | loss: 0.1024802
	speed: 0.0342s/iter; left time: 731.4285s
	iters: 600, epoch: 2 | loss: 0.1311831
	speed: 0.0334s/iter; left time: 711.1587s
	iters: 700, epoch: 2 | loss: 0.1205591
	speed: 0.0334s/iter; left time: 708.4610s
Epoch: 2 cost time: 25.55518913269043
Epoch: 2, Steps: 755 | Train Loss: 0.1521486 Vali Loss: 0.1300011 Test Loss: 0.2165481
Validation loss decreased (0.250706 --> 0.130001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0850268
	speed: 0.1697s/iter; left time: 3570.2271s
	iters: 200, epoch: 3 | loss: 0.0859479
	speed: 0.0332s/iter; left time: 694.7981s
	iters: 300, epoch: 3 | loss: 0.0970978
	speed: 0.0341s/iter; left time: 710.3779s
	iters: 400, epoch: 3 | loss: 0.0718896
	speed: 0.0334s/iter; left time: 693.1958s
	iters: 500, epoch: 3 | loss: 0.0834817
	speed: 0.0343s/iter; left time: 708.8598s
	iters: 600, epoch: 3 | loss: 0.0932844
	speed: 0.0346s/iter; left time: 711.5327s
	iters: 700, epoch: 3 | loss: 0.0660268
	speed: 0.0334s/iter; left time: 683.3794s
Epoch: 3 cost time: 25.515135288238525
Epoch: 3, Steps: 755 | Train Loss: 0.1006901 Vali Loss: 0.0969836 Test Loss: 0.1773293
Validation loss decreased (0.130001 --> 0.096984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0579259
	speed: 0.1679s/iter; left time: 3405.4490s
	iters: 200, epoch: 4 | loss: 0.0645938
	speed: 0.0337s/iter; left time: 680.7237s
	iters: 300, epoch: 4 | loss: 0.0655659
	speed: 0.0331s/iter; left time: 663.9817s
	iters: 400, epoch: 4 | loss: 0.1036687
	speed: 0.0338s/iter; left time: 675.7117s
	iters: 500, epoch: 4 | loss: 0.0744403
	speed: 0.0334s/iter; left time: 663.6011s
	iters: 600, epoch: 4 | loss: 0.0848834
	speed: 0.0337s/iter; left time: 666.5463s
	iters: 700, epoch: 4 | loss: 0.0689784
	speed: 0.0333s/iter; left time: 655.8610s
Epoch: 4 cost time: 25.3941650390625
Epoch: 4, Steps: 755 | Train Loss: 0.0846380 Vali Loss: 0.0875546 Test Loss: 0.1646673
Validation loss decreased (0.096984 --> 0.087555).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0820038
	speed: 0.1767s/iter; left time: 3452.0474s
	iters: 200, epoch: 5 | loss: 0.0650315
	speed: 0.0340s/iter; left time: 661.2856s
	iters: 300, epoch: 5 | loss: 0.0628424
	speed: 0.0342s/iter; left time: 661.2744s
	iters: 400, epoch: 5 | loss: 0.0531748
	speed: 0.0333s/iter; left time: 640.5290s
	iters: 500, epoch: 5 | loss: 0.1219346
	speed: 0.0341s/iter; left time: 651.5953s
	iters: 600, epoch: 5 | loss: 0.0540428
	speed: 0.0344s/iter; left time: 654.5190s
	iters: 700, epoch: 5 | loss: 0.0766312
	speed: 0.0336s/iter; left time: 636.9821s
Epoch: 5 cost time: 25.624879121780396
Epoch: 5, Steps: 755 | Train Loss: 0.0767098 Vali Loss: 0.0830556 Test Loss: 0.1589340
Validation loss decreased (0.087555 --> 0.083056).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0528183
	speed: 0.1728s/iter; left time: 3244.8818s
	iters: 200, epoch: 6 | loss: 0.0480587
	speed: 0.0339s/iter; left time: 632.6276s
	iters: 300, epoch: 6 | loss: 0.0680303
	speed: 0.0333s/iter; left time: 617.9545s
	iters: 400, epoch: 6 | loss: 0.0715263
	speed: 0.0336s/iter; left time: 620.6026s
	iters: 500, epoch: 6 | loss: 0.0822539
	speed: 0.0343s/iter; left time: 629.9491s
	iters: 600, epoch: 6 | loss: 0.0520782
	speed: 0.0336s/iter; left time: 613.8258s
	iters: 700, epoch: 6 | loss: 0.0544641
	speed: 0.0331s/iter; left time: 602.0234s
Epoch: 6 cost time: 25.530543565750122
Epoch: 6, Steps: 755 | Train Loss: 0.0717542 Vali Loss: 0.0803503 Test Loss: 0.1527266
Validation loss decreased (0.083056 --> 0.080350).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1237222
	speed: 0.1724s/iter; left time: 3106.5995s
	iters: 200, epoch: 7 | loss: 0.0602288
	speed: 0.0329s/iter; left time: 589.6308s
	iters: 300, epoch: 7 | loss: 0.0555341
	speed: 0.0337s/iter; left time: 601.3858s
	iters: 400, epoch: 7 | loss: 0.0471036
	speed: 0.0348s/iter; left time: 616.0908s
	iters: 500, epoch: 7 | loss: 0.0849418
	speed: 0.0339s/iter; left time: 597.2728s
	iters: 600, epoch: 7 | loss: 0.0628771
	speed: 0.0335s/iter; left time: 587.0714s
	iters: 700, epoch: 7 | loss: 0.0788777
	speed: 0.0333s/iter; left time: 579.6480s
Epoch: 7 cost time: 25.561217784881592
Epoch: 7, Steps: 755 | Train Loss: 0.0675838 Vali Loss: 0.0778662 Test Loss: 0.1484862
Validation loss decreased (0.080350 --> 0.077866).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0519077
	speed: 0.1728s/iter; left time: 2984.3522s
	iters: 200, epoch: 8 | loss: 0.0555076
	speed: 0.0333s/iter; left time: 572.2056s
	iters: 300, epoch: 8 | loss: 0.0598595
	speed: 0.0330s/iter; left time: 562.4807s
	iters: 400, epoch: 8 | loss: 0.0352782
	speed: 0.0338s/iter; left time: 572.7902s
	iters: 500, epoch: 8 | loss: 0.0629251
	speed: 0.0335s/iter; left time: 565.0125s
	iters: 600, epoch: 8 | loss: 0.0433064
	speed: 0.0338s/iter; left time: 566.0548s
	iters: 700, epoch: 8 | loss: 0.0718196
	speed: 0.0334s/iter; left time: 555.9702s
Epoch: 8 cost time: 25.466734647750854
Epoch: 8, Steps: 755 | Train Loss: 0.0647562 Vali Loss: 0.0764705 Test Loss: 0.1460433
Validation loss decreased (0.077866 --> 0.076470).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0502806
	speed: 0.1736s/iter; left time: 2866.5205s
	iters: 200, epoch: 9 | loss: 0.0732401
	speed: 0.0341s/iter; left time: 559.8094s
	iters: 300, epoch: 9 | loss: 0.0646681
	speed: 0.0338s/iter; left time: 551.2809s
	iters: 400, epoch: 9 | loss: 0.0374980
	speed: 0.0345s/iter; left time: 559.9224s
	iters: 500, epoch: 9 | loss: 0.0497754
	speed: 0.0332s/iter; left time: 535.4424s
	iters: 600, epoch: 9 | loss: 0.0463407
	speed: 0.0336s/iter; left time: 537.9773s
	iters: 700, epoch: 9 | loss: 0.0853895
	speed: 0.0330s/iter; left time: 525.7652s
Epoch: 9 cost time: 25.461597442626953
Epoch: 9, Steps: 755 | Train Loss: 0.0621654 Vali Loss: 0.0755869 Test Loss: 0.1442565
Validation loss decreased (0.076470 --> 0.075587).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1173972
	speed: 0.1686s/iter; left time: 2656.0100s
	iters: 200, epoch: 10 | loss: 0.0383438
	speed: 0.0331s/iter; left time: 518.2064s
	iters: 300, epoch: 10 | loss: 0.0602041
	speed: 0.0345s/iter; left time: 536.2629s
	iters: 400, epoch: 10 | loss: 0.0457951
	speed: 0.0332s/iter; left time: 513.6303s
	iters: 500, epoch: 10 | loss: 0.0725269
	speed: 0.0331s/iter; left time: 508.2929s
	iters: 600, epoch: 10 | loss: 0.0676995
	speed: 0.0333s/iter; left time: 507.3309s
	iters: 700, epoch: 10 | loss: 0.0542511
	speed: 0.0335s/iter; left time: 507.3504s
Epoch: 10 cost time: 25.316866636276245
Epoch: 10, Steps: 755 | Train Loss: 0.0607612 Vali Loss: 0.0747099 Test Loss: 0.1434724
Validation loss decreased (0.075587 --> 0.074710).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0399939
	speed: 0.1776s/iter; left time: 2664.6064s
	iters: 200, epoch: 11 | loss: 0.0394278
	speed: 0.0340s/iter; left time: 506.2387s
	iters: 300, epoch: 11 | loss: 0.0655679
	speed: 0.0334s/iter; left time: 494.8666s
	iters: 400, epoch: 11 | loss: 0.0738115
	speed: 0.0341s/iter; left time: 501.5922s
	iters: 500, epoch: 11 | loss: 0.0587767
	speed: 0.0332s/iter; left time: 484.7933s
	iters: 600, epoch: 11 | loss: 0.0675392
	speed: 0.0328s/iter; left time: 476.1740s
	iters: 700, epoch: 11 | loss: 0.0739058
	speed: 0.0338s/iter; left time: 486.2527s
Epoch: 11 cost time: 25.625498294830322
Epoch: 11, Steps: 755 | Train Loss: 0.0590134 Vali Loss: 0.0744287 Test Loss: 0.1427054
Validation loss decreased (0.074710 --> 0.074429).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0369164
	speed: 0.1727s/iter; left time: 2460.0701s
	iters: 200, epoch: 12 | loss: 0.0371401
	speed: 0.0343s/iter; left time: 484.6730s
	iters: 300, epoch: 12 | loss: 0.0467552
	speed: 0.0341s/iter; left time: 479.6445s
	iters: 400, epoch: 12 | loss: 0.0497134
	speed: 0.0345s/iter; left time: 481.5172s
	iters: 500, epoch: 12 | loss: 0.0737437
	speed: 0.0337s/iter; left time: 466.9793s
	iters: 600, epoch: 12 | loss: 0.0834383
	speed: 0.0344s/iter; left time: 472.9724s
	iters: 700, epoch: 12 | loss: 0.0468393
	speed: 0.0339s/iter; left time: 462.9353s
Epoch: 12 cost time: 25.706258058547974
Epoch: 12, Steps: 755 | Train Loss: 0.0578220 Vali Loss: 0.0734398 Test Loss: 0.1414466
Validation loss decreased (0.074429 --> 0.073440).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0387781
	speed: 0.1681s/iter; left time: 2268.1187s
	iters: 200, epoch: 13 | loss: 0.0991789
	speed: 0.0332s/iter; left time: 444.2631s
	iters: 300, epoch: 13 | loss: 0.0571389
	speed: 0.0331s/iter; left time: 439.5102s
	iters: 400, epoch: 13 | loss: 0.0570398
	speed: 0.0340s/iter; left time: 448.9971s
	iters: 500, epoch: 13 | loss: 0.0503315
	speed: 0.0333s/iter; left time: 436.3473s
	iters: 600, epoch: 13 | loss: 0.0470236
	speed: 0.0330s/iter; left time: 429.1487s
	iters: 700, epoch: 13 | loss: 0.0553304
	speed: 0.0339s/iter; left time: 436.4153s
Epoch: 13 cost time: 25.253446578979492
Epoch: 13, Steps: 755 | Train Loss: 0.0571585 Vali Loss: 0.0742125 Test Loss: 0.1417652
EarlyStopping counter: 1 out of 2
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0526616
	speed: 0.1651s/iter; left time: 2103.2995s
	iters: 200, epoch: 14 | loss: 0.0844796
	speed: 0.0334s/iter; left time: 422.3403s
	iters: 300, epoch: 14 | loss: 0.0521976
	speed: 0.0344s/iter; left time: 430.8068s
	iters: 400, epoch: 14 | loss: 0.0406276
	speed: 0.0335s/iter; left time: 416.8421s
	iters: 500, epoch: 14 | loss: 0.0875360
	speed: 0.0332s/iter; left time: 408.9672s
	iters: 600, epoch: 14 | loss: 0.0480160
	speed: 0.0344s/iter; left time: 421.4204s
	iters: 700, epoch: 14 | loss: 0.0323475
	speed: 0.0343s/iter; left time: 416.7570s
Epoch: 14 cost time: 25.685297966003418
Epoch: 14, Steps: 755 | Train Loss: 0.0562186 Vali Loss: 0.0731993 Test Loss: 0.1402822
Validation loss decreased (0.073440 --> 0.073199).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0650437
	speed: 0.1677s/iter; left time: 2008.8360s
	iters: 200, epoch: 15 | loss: 0.0390842
	speed: 0.0335s/iter; left time: 398.6032s
	iters: 300, epoch: 15 | loss: 0.0843561
	speed: 0.0334s/iter; left time: 393.6373s
	iters: 400, epoch: 15 | loss: 0.0579950
	speed: 0.0344s/iter; left time: 401.7920s
	iters: 500, epoch: 15 | loss: 0.0524543
	speed: 0.0330s/iter; left time: 382.0209s
	iters: 600, epoch: 15 | loss: 0.0488452
	speed: 0.0334s/iter; left time: 383.4947s
	iters: 700, epoch: 15 | loss: 0.0610693
	speed: 0.0332s/iter; left time: 378.1456s
Epoch: 15 cost time: 25.34071922302246
Epoch: 15, Steps: 755 | Train Loss: 0.0554993 Vali Loss: 0.0730093 Test Loss: 0.1400501
Validation loss decreased (0.073199 --> 0.073009).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0427110
	speed: 0.1678s/iter; left time: 1883.9019s
	iters: 200, epoch: 16 | loss: 0.0752449
	speed: 0.0332s/iter; left time: 369.1027s
	iters: 300, epoch: 16 | loss: 0.0584047
	speed: 0.0342s/iter; left time: 376.5382s
	iters: 400, epoch: 16 | loss: 0.0359048
	speed: 0.0331s/iter; left time: 361.5795s
	iters: 500, epoch: 16 | loss: 0.0453305
	speed: 0.0332s/iter; left time: 359.3995s
	iters: 600, epoch: 16 | loss: 0.0403132
	speed: 0.0336s/iter; left time: 360.3035s
	iters: 700, epoch: 16 | loss: 0.0525028
	speed: 0.0338s/iter; left time: 359.3678s
Epoch: 16 cost time: 25.506716012954712
Epoch: 16, Steps: 755 | Train Loss: 0.0547738 Vali Loss: 0.0726493 Test Loss: 0.1398889
Validation loss decreased (0.073009 --> 0.072649).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0599485
	speed: 0.1749s/iter; left time: 1831.1583s
	iters: 200, epoch: 17 | loss: 0.0519936
	speed: 0.0343s/iter; left time: 355.7061s
	iters: 300, epoch: 17 | loss: 0.0320895
	speed: 0.0342s/iter; left time: 351.1740s
	iters: 400, epoch: 17 | loss: 0.0363359
	speed: 0.0338s/iter; left time: 344.0868s
	iters: 500, epoch: 17 | loss: 0.0432456
	speed: 0.0342s/iter; left time: 344.6505s
	iters: 600, epoch: 17 | loss: 0.0445909
	speed: 0.0332s/iter; left time: 330.5555s
	iters: 700, epoch: 17 | loss: 0.0535211
	speed: 0.0329s/iter; left time: 324.6994s
Epoch: 17 cost time: 25.48380184173584
Epoch: 17, Steps: 755 | Train Loss: 0.0542554 Vali Loss: 0.0727300 Test Loss: 0.1397420
EarlyStopping counter: 1 out of 2
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0577385
	speed: 0.1719s/iter; left time: 1669.7247s
	iters: 200, epoch: 18 | loss: 0.0772846
	speed: 0.0338s/iter; left time: 324.7172s
	iters: 300, epoch: 18 | loss: 0.0759928
	speed: 0.0341s/iter; left time: 324.2692s
	iters: 400, epoch: 18 | loss: 0.0672114
	speed: 0.0331s/iter; left time: 311.6045s
	iters: 500, epoch: 18 | loss: 0.0444895
	speed: 0.0338s/iter; left time: 315.0779s
	iters: 600, epoch: 18 | loss: 0.0514885
	speed: 0.0338s/iter; left time: 311.5406s
	iters: 700, epoch: 18 | loss: 0.0353887
	speed: 0.0339s/iter; left time: 308.6332s
Epoch: 18 cost time: 25.809691190719604
Epoch: 18, Steps: 755 | Train Loss: 0.0541440 Vali Loss: 0.0725281 Test Loss: 0.1389208
Validation loss decreased (0.072649 --> 0.072528).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0434192
	speed: 0.1719s/iter; left time: 1540.1107s
	iters: 200, epoch: 19 | loss: 0.0489377
	speed: 0.0338s/iter; left time: 299.7783s
	iters: 300, epoch: 19 | loss: 0.0751233
	speed: 0.0332s/iter; left time: 290.5149s
	iters: 400, epoch: 19 | loss: 0.0375861
	speed: 0.0333s/iter; left time: 288.1939s
	iters: 500, epoch: 19 | loss: 0.0355555
	speed: 0.0332s/iter; left time: 283.9242s
	iters: 600, epoch: 19 | loss: 0.0462517
	speed: 0.0339s/iter; left time: 286.7569s
	iters: 700, epoch: 19 | loss: 0.0456356
	speed: 0.0328s/iter; left time: 274.2782s
Epoch: 19 cost time: 25.471574783325195
Epoch: 19, Steps: 755 | Train Loss: 0.0534139 Vali Loss: 0.0733566 Test Loss: 0.1401119
EarlyStopping counter: 1 out of 2
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0362967
	speed: 0.1751s/iter; left time: 1436.9014s
	iters: 200, epoch: 20 | loss: 0.0325633
	speed: 0.0333s/iter; left time: 269.6298s
	iters: 300, epoch: 20 | loss: 0.0414997
	speed: 0.0334s/iter; left time: 267.3298s
	iters: 400, epoch: 20 | loss: 0.0400459
	speed: 0.0334s/iter; left time: 263.6745s
	iters: 500, epoch: 20 | loss: 0.0393462
	speed: 0.0333s/iter; left time: 259.5577s
	iters: 600, epoch: 20 | loss: 0.0580598
	speed: 0.0337s/iter; left time: 259.8687s
	iters: 700, epoch: 20 | loss: 0.0557521
	speed: 0.0330s/iter; left time: 250.7059s
Epoch: 20 cost time: 25.20625329017639
Epoch: 20, Steps: 755 | Train Loss: 0.0532922 Vali Loss: 0.0725821 Test Loss: 0.1393349
EarlyStopping counter: 2 out of 2
Early stopping
>>>>>>>testing : traffic_96_96_MLPAer_univariate_custom_ftMS_sl96_ll48_pl96_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.13892078399658203, mae:0.21576093137264252, rse:0.276382178068161
