Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='ETTm2_96_336', model='MLPAer_univariate', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, fc_dropout=0.05, head_dropout=0.7, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=1, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=21, t_ff=256, c_dropout=0.1, t_dropout=0.5, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_336_MLPAer_univariate_ETTm2_ftMS_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3037507
	speed: 0.0457s/iter; left time: 1457.0148s
	iters: 200, epoch: 1 | loss: 0.2163893
	speed: 0.0088s/iter; left time: 279.6498s
	iters: 300, epoch: 1 | loss: 0.2667844
	speed: 0.0085s/iter; left time: 268.9131s
	iters: 400, epoch: 1 | loss: 0.2917594
	speed: 0.0086s/iter; left time: 272.4774s
	iters: 500, epoch: 1 | loss: 0.3530609
	speed: 0.0085s/iter; left time: 268.9002s
	iters: 600, epoch: 1 | loss: 0.1827217
	speed: 0.0087s/iter; left time: 272.5016s
	iters: 700, epoch: 1 | loss: 0.2424924
	speed: 0.0085s/iter; left time: 264.8864s
	iters: 800, epoch: 1 | loss: 0.2551224
	speed: 0.0084s/iter; left time: 260.7020s
	iters: 900, epoch: 1 | loss: 0.2928607
	speed: 0.0085s/iter; left time: 263.8557s
	iters: 1000, epoch: 1 | loss: 0.2680020
	speed: 0.0085s/iter; left time: 262.6718s
Epoch: 1 cost time: 9.589675664901733
Epoch: 1, Steps: 1066 | Train Loss: 0.2624985 Vali Loss: 0.2467494 Test Loss: 0.1688978
Validation loss decreased (inf --> 0.246749).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1816044
	speed: 0.0656s/iter; left time: 2021.7723s
	iters: 200, epoch: 2 | loss: 0.2038990
	speed: 0.0087s/iter; left time: 267.6525s
	iters: 300, epoch: 2 | loss: 0.1987380
	speed: 0.0088s/iter; left time: 269.1302s
	iters: 400, epoch: 2 | loss: 0.2078557
	speed: 0.0089s/iter; left time: 273.0646s
	iters: 500, epoch: 2 | loss: 0.1772228
	speed: 0.0087s/iter; left time: 263.7679s
	iters: 600, epoch: 2 | loss: 0.2791274
	speed: 0.0083s/iter; left time: 252.5738s
	iters: 700, epoch: 2 | loss: 0.2415606
	speed: 0.0085s/iter; left time: 256.8214s
	iters: 800, epoch: 2 | loss: 0.2496114
	speed: 0.0084s/iter; left time: 252.7973s
	iters: 900, epoch: 2 | loss: 0.2819819
	speed: 0.0088s/iter; left time: 263.9985s
	iters: 1000, epoch: 2 | loss: 0.2077067
	speed: 0.0086s/iter; left time: 258.7153s
Epoch: 2 cost time: 9.402842283248901
Epoch: 2, Steps: 1066 | Train Loss: 0.2140782 Vali Loss: 0.2124147 Test Loss: 0.1309795
Validation loss decreased (0.246749 --> 0.212415).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2232019
	speed: 0.0636s/iter; left time: 1891.3526s
	iters: 200, epoch: 3 | loss: 0.2381396
	speed: 0.0084s/iter; left time: 247.8371s
	iters: 300, epoch: 3 | loss: 0.1334274
	speed: 0.0084s/iter; left time: 247.8889s
	iters: 400, epoch: 3 | loss: 0.1982776
	speed: 0.0087s/iter; left time: 255.5965s
	iters: 500, epoch: 3 | loss: 0.1748773
	speed: 0.0084s/iter; left time: 245.2921s
	iters: 600, epoch: 3 | loss: 0.1612535
	speed: 0.0083s/iter; left time: 244.1154s
	iters: 700, epoch: 3 | loss: 0.2257678
	speed: 0.0086s/iter; left time: 252.0130s
	iters: 800, epoch: 3 | loss: 0.1911292
	speed: 0.0084s/iter; left time: 244.5927s
	iters: 900, epoch: 3 | loss: 0.2271237
	speed: 0.0085s/iter; left time: 245.0252s
	iters: 1000, epoch: 3 | loss: 0.1420878
	speed: 0.0085s/iter; left time: 246.5360s
Epoch: 3 cost time: 9.207923650741577
Epoch: 3, Steps: 1066 | Train Loss: 0.2057981 Vali Loss: 0.2104044 Test Loss: 0.1294557
Validation loss decreased (0.212415 --> 0.210404).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2453424
	speed: 0.0627s/iter; left time: 1797.3350s
	iters: 200, epoch: 4 | loss: 0.1945948
	speed: 0.0084s/iter; left time: 238.9389s
	iters: 300, epoch: 4 | loss: 0.1284665
	speed: 0.0084s/iter; left time: 239.1208s
	iters: 400, epoch: 4 | loss: 0.2813063
	speed: 0.0085s/iter; left time: 240.1692s
	iters: 500, epoch: 4 | loss: 0.2036736
	speed: 0.0083s/iter; left time: 233.7060s
	iters: 600, epoch: 4 | loss: 0.2020192
	speed: 0.0084s/iter; left time: 235.9959s
	iters: 700, epoch: 4 | loss: 0.1726700
	speed: 0.0083s/iter; left time: 232.3713s
	iters: 800, epoch: 4 | loss: 0.1400607
	speed: 0.0089s/iter; left time: 250.0346s
	iters: 900, epoch: 4 | loss: 0.2220288
	speed: 0.0087s/iter; left time: 241.4133s
	iters: 1000, epoch: 4 | loss: 0.2811323
	speed: 0.0086s/iter; left time: 238.4467s
Epoch: 4 cost time: 9.236382484436035
Epoch: 4, Steps: 1066 | Train Loss: 0.2031139 Vali Loss: 0.2082133 Test Loss: 0.1295320
Validation loss decreased (0.210404 --> 0.208213).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2111474
	speed: 0.0657s/iter; left time: 1813.8245s
	iters: 200, epoch: 5 | loss: 0.1805661
	speed: 0.0084s/iter; left time: 232.0496s
	iters: 300, epoch: 5 | loss: 0.2179640
	speed: 0.0087s/iter; left time: 237.6956s
	iters: 400, epoch: 5 | loss: 0.1926341
	speed: 0.0086s/iter; left time: 235.3466s
	iters: 500, epoch: 5 | loss: 0.1812571
	speed: 0.0082s/iter; left time: 224.4810s
	iters: 600, epoch: 5 | loss: 0.2194612
	speed: 0.0085s/iter; left time: 231.1615s
	iters: 700, epoch: 5 | loss: 0.2238975
	speed: 0.0083s/iter; left time: 224.8789s
	iters: 800, epoch: 5 | loss: 0.1762979
	speed: 0.0086s/iter; left time: 230.3225s
	iters: 900, epoch: 5 | loss: 0.1709630
	speed: 0.0084s/iter; left time: 224.0034s
	iters: 1000, epoch: 5 | loss: 0.1747850
	speed: 0.0085s/iter; left time: 227.4921s
Epoch: 5 cost time: 9.280413627624512
Epoch: 5, Steps: 1066 | Train Loss: 0.2006290 Vali Loss: 0.2056158 Test Loss: 0.1291680
Validation loss decreased (0.208213 --> 0.205616).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2119081
	speed: 0.0651s/iter; left time: 1729.4924s
	iters: 200, epoch: 6 | loss: 0.1875040
	speed: 0.0084s/iter; left time: 221.6205s
	iters: 300, epoch: 6 | loss: 0.1631575
	speed: 0.0085s/iter; left time: 224.6293s
	iters: 400, epoch: 6 | loss: 0.2694895
	speed: 0.0083s/iter; left time: 218.4834s
	iters: 500, epoch: 6 | loss: 0.1406383
	speed: 0.0084s/iter; left time: 218.6382s
	iters: 600, epoch: 6 | loss: 0.1764655
	speed: 0.0086s/iter; left time: 225.0748s
	iters: 700, epoch: 6 | loss: 0.1780171
	speed: 0.0083s/iter; left time: 216.4430s
	iters: 800, epoch: 6 | loss: 0.2070732
	speed: 0.0082s/iter; left time: 212.9930s
	iters: 900, epoch: 6 | loss: 0.1546907
	speed: 0.0084s/iter; left time: 217.5870s
	iters: 1000, epoch: 6 | loss: 0.1249456
	speed: 0.0083s/iter; left time: 212.0470s
Epoch: 6 cost time: 9.301657915115356
Epoch: 6, Steps: 1066 | Train Loss: 0.1983675 Vali Loss: 0.2026539 Test Loss: 0.1294318
Validation loss decreased (0.205616 --> 0.202654).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2152648
	speed: 0.0639s/iter; left time: 1629.4252s
	iters: 200, epoch: 7 | loss: 0.2035451
	speed: 0.0087s/iter; left time: 220.2505s
	iters: 300, epoch: 7 | loss: 0.1962832
	speed: 0.0085s/iter; left time: 214.6581s
	iters: 400, epoch: 7 | loss: 0.1954185
	speed: 0.0083s/iter; left time: 209.6398s
	iters: 500, epoch: 7 | loss: 0.2229593
	speed: 0.0083s/iter; left time: 207.5982s
	iters: 600, epoch: 7 | loss: 0.2359623
	speed: 0.0091s/iter; left time: 226.3775s
	iters: 700, epoch: 7 | loss: 0.1949978
	speed: 0.0085s/iter; left time: 211.3218s
	iters: 800, epoch: 7 | loss: 0.2713187
	speed: 0.0086s/iter; left time: 212.1149s
	iters: 900, epoch: 7 | loss: 0.2009269
	speed: 0.0088s/iter; left time: 216.9964s
	iters: 1000, epoch: 7 | loss: 0.2085935
	speed: 0.0083s/iter; left time: 204.1017s
Epoch: 7 cost time: 9.312433004379272
Epoch: 7, Steps: 1066 | Train Loss: 0.1957561 Vali Loss: 0.2020713 Test Loss: 0.1289919
Validation loss decreased (0.202654 --> 0.202071).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1530096
	speed: 0.0649s/iter; left time: 1585.3580s
	iters: 200, epoch: 8 | loss: 0.2177878
	speed: 0.0088s/iter; left time: 212.9152s
	iters: 300, epoch: 8 | loss: 0.1713698
	speed: 0.0089s/iter; left time: 215.8900s
	iters: 400, epoch: 8 | loss: 0.1785344
	speed: 0.0089s/iter; left time: 214.0818s
	iters: 500, epoch: 8 | loss: 0.2199735
	speed: 0.0087s/iter; left time: 208.3620s
	iters: 600, epoch: 8 | loss: 0.2301679
	speed: 0.0087s/iter; left time: 208.3497s
	iters: 700, epoch: 8 | loss: 0.2099172
	speed: 0.0089s/iter; left time: 211.0925s
	iters: 800, epoch: 8 | loss: 0.2090955
	speed: 0.0084s/iter; left time: 200.1650s
	iters: 900, epoch: 8 | loss: 0.1964788
	speed: 0.0085s/iter; left time: 199.6365s
	iters: 1000, epoch: 8 | loss: 0.1912978
	speed: 0.0088s/iter; left time: 206.0644s
Epoch: 8 cost time: 9.517172574996948
Epoch: 8, Steps: 1066 | Train Loss: 0.1946313 Vali Loss: 0.2001475 Test Loss: 0.1293107
Validation loss decreased (0.202071 --> 0.200147).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1430219
	speed: 0.0639s/iter; left time: 1492.8687s
	iters: 200, epoch: 9 | loss: 0.1435846
	speed: 0.0091s/iter; left time: 212.7591s
	iters: 300, epoch: 9 | loss: 0.1809652
	speed: 0.0086s/iter; left time: 198.9614s
	iters: 400, epoch: 9 | loss: 0.1740772
	speed: 0.0085s/iter; left time: 195.8334s
	iters: 500, epoch: 9 | loss: 0.1891558
	speed: 0.0085s/iter; left time: 195.9026s
	iters: 600, epoch: 9 | loss: 0.1802099
	speed: 0.0091s/iter; left time: 206.9352s
	iters: 700, epoch: 9 | loss: 0.1695517
	speed: 0.0087s/iter; left time: 197.0514s
	iters: 800, epoch: 9 | loss: 0.2199978
	speed: 0.0088s/iter; left time: 198.2760s
	iters: 900, epoch: 9 | loss: 0.1499270
	speed: 0.0087s/iter; left time: 195.2571s
	iters: 1000, epoch: 9 | loss: 0.2069377
	speed: 0.0085s/iter; left time: 191.0993s
Epoch: 9 cost time: 9.514623403549194
Epoch: 9, Steps: 1066 | Train Loss: 0.1936133 Vali Loss: 0.2001508 Test Loss: 0.1291398
EarlyStopping counter: 1 out of 1
Early stopping
>>>>>>>testing : ETTm2_96_336_MLPAer_univariate_ETTm2_ftMS_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.1293107569217682, mae:0.27390921115875244, rse:0.5875599384307861
