Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='do_425012_96_336', model='MLPAer_univariate', data='custom', root_path='./dataset/', data_path='do_425012.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, fc_dropout=0.05, head_dropout=0.2, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=7, t_ff=128, c_dropout=0.0, t_dropout=0.0, embed_dropout=0.0, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : do_425012_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 53704
val 7399
test 15132
	iters: 100, epoch: 1 | loss: 0.4340844
	speed: 0.0343s/iter; left time: 427.5565s
	iters: 200, epoch: 1 | loss: 0.3364447
	speed: 0.0168s/iter; left time: 207.7769s
	iters: 300, epoch: 1 | loss: 0.4217888
	speed: 0.0158s/iter; left time: 193.3370s
	iters: 400, epoch: 1 | loss: 0.4058471
	speed: 0.0151s/iter; left time: 183.7073s
Epoch: 1 cost time: 7.034919738769531
Epoch: 1, Steps: 419 | Train Loss: 0.3456918 Vali Loss: 0.2993088 Test Loss: 0.3831164
Validation loss decreased (inf --> 0.299309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2831604
	speed: 0.0500s/iter; left time: 602.1493s
	iters: 200, epoch: 2 | loss: 0.3222776
	speed: 0.0161s/iter; left time: 192.2919s
	iters: 300, epoch: 2 | loss: 0.2748341
	speed: 0.0154s/iter; left time: 183.0998s
	iters: 400, epoch: 2 | loss: 0.2362135
	speed: 0.0155s/iter; left time: 182.5666s
Epoch: 2 cost time: 6.655256509780884
Epoch: 2, Steps: 419 | Train Loss: 0.3073729 Vali Loss: 0.2989919 Test Loss: 0.3442325
Validation loss decreased (0.299309 --> 0.298992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3138223
	speed: 0.0518s/iter; left time: 602.4268s
	iters: 200, epoch: 3 | loss: 0.2968907
	speed: 0.0161s/iter; left time: 186.2328s
	iters: 300, epoch: 3 | loss: 0.3512157
	speed: 0.0190s/iter; left time: 217.1300s
	iters: 400, epoch: 3 | loss: 0.3032156
	speed: 0.0164s/iter; left time: 185.9772s
Epoch: 3 cost time: 7.221827745437622
Epoch: 3, Steps: 419 | Train Loss: 0.2996632 Vali Loss: 0.3012704 Test Loss: 0.3412849
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2816206
	speed: 0.0491s/iter; left time: 550.3672s
	iters: 200, epoch: 4 | loss: 0.2844170
	speed: 0.0160s/iter; left time: 178.3278s
	iters: 300, epoch: 4 | loss: 0.3465546
	speed: 0.0157s/iter; left time: 173.3468s
	iters: 400, epoch: 4 | loss: 0.2558404
	speed: 0.0146s/iter; left time: 159.1623s
Epoch: 4 cost time: 6.552236795425415
Epoch: 4, Steps: 419 | Train Loss: 0.2979950 Vali Loss: 0.2967363 Test Loss: 0.3410671
Validation loss decreased (0.298992 --> 0.296736).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2602701
	speed: 0.0606s/iter; left time: 654.1945s
	iters: 200, epoch: 5 | loss: 0.3040309
	speed: 0.0161s/iter; left time: 172.6550s
	iters: 300, epoch: 5 | loss: 0.2765132
	speed: 0.0159s/iter; left time: 167.9629s
	iters: 400, epoch: 5 | loss: 0.3573467
	speed: 0.0161s/iter; left time: 169.3119s
Epoch: 5 cost time: 6.831342458724976
Epoch: 5, Steps: 419 | Train Loss: 0.2967511 Vali Loss: 0.3051553 Test Loss: 0.3407873
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4204384
	speed: 0.0554s/iter; left time: 574.5295s
	iters: 200, epoch: 6 | loss: 0.3754980
	speed: 0.0194s/iter; left time: 199.6558s
	iters: 300, epoch: 6 | loss: 0.2770403
	speed: 0.0154s/iter; left time: 156.9165s
	iters: 400, epoch: 6 | loss: 0.2547616
	speed: 0.0165s/iter; left time: 166.4626s
Epoch: 6 cost time: 7.269019365310669
Epoch: 6, Steps: 419 | Train Loss: 0.2956866 Vali Loss: 0.3033938 Test Loss: 0.3386983
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3049396
	speed: 0.0505s/iter; left time: 502.4410s
	iters: 200, epoch: 7 | loss: 0.2466019
	speed: 0.0180s/iter; left time: 177.8919s
	iters: 300, epoch: 7 | loss: 0.2760449
	speed: 0.0184s/iter; left time: 179.6204s
	iters: 400, epoch: 7 | loss: 0.2940585
	speed: 0.0203s/iter; left time: 196.3368s
Epoch: 7 cost time: 7.925892114639282
Epoch: 7, Steps: 419 | Train Loss: 0.2943362 Vali Loss: 0.3022704 Test Loss: 0.3394655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : do_425012_96_336_MLPAer_univariate_custom_ftMS_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 15132
find shape (15104, 336, 1) (15104, 336, 1)
mse:0.3410671651363373, mae:0.37995222210884094, nse:0.585277259349823, mape:0.9323936104774475
