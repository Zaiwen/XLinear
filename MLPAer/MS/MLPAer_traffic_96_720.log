Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='traffic_96_720', model='MLPAer_univariate', data='custom', root_path='./dataset/', data_path='traffic.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, fc_dropout=0.05, head_dropout=0.7, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=2048, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=48, t_ff=336, c_dropout=0.1, t_dropout=0.3, embed_dropout=0.3, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_720_MLPAer_univariate_custom_ftMS_sl96_ll48_pl720_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.9089090
	speed: 0.0896s/iter; left time: 1915.1632s
	iters: 200, epoch: 1 | loss: 0.7880236
	speed: 0.0671s/iter; left time: 1428.3471s
	iters: 300, epoch: 1 | loss: 0.6154474
	speed: 0.0692s/iter; left time: 1465.1368s
	iters: 400, epoch: 1 | loss: 0.4638515
	speed: 0.0680s/iter; left time: 1432.6113s
	iters: 500, epoch: 1 | loss: 0.4261844
	speed: 0.0683s/iter; left time: 1433.8793s
	iters: 600, epoch: 1 | loss: 0.3413624
	speed: 0.0691s/iter; left time: 1443.8922s
	iters: 700, epoch: 1 | loss: 0.2747808
	speed: 0.0685s/iter; left time: 1422.6432s
Epoch: 1 cost time: 49.67547082901001
Epoch: 1, Steps: 716 | Train Loss: 0.5875238 Vali Loss: 0.2599597 Test Loss: 0.3786147
Validation loss decreased (inf --> 0.259960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1935011
	speed: 0.3097s/iter; left time: 6400.4330s
	iters: 200, epoch: 2 | loss: 0.1718611
	speed: 0.0687s/iter; left time: 1413.5539s
	iters: 300, epoch: 2 | loss: 0.1505223
	speed: 0.0680s/iter; left time: 1391.2696s
	iters: 400, epoch: 2 | loss: 0.1529371
	speed: 0.0687s/iter; left time: 1399.2805s
	iters: 500, epoch: 2 | loss: 0.1348307
	speed: 0.0687s/iter; left time: 1392.4391s
	iters: 600, epoch: 2 | loss: 0.1599448
	speed: 0.0687s/iter; left time: 1385.9224s
	iters: 700, epoch: 2 | loss: 0.1408173
	speed: 0.0678s/iter; left time: 1360.3887s
Epoch: 2 cost time: 49.07971262931824
Epoch: 2, Steps: 716 | Train Loss: 0.1634248 Vali Loss: 0.1510033 Test Loss: 0.2355407
Validation loss decreased (0.259960 --> 0.151003).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1387865
	speed: 0.3060s/iter; left time: 6105.0211s
	iters: 200, epoch: 3 | loss: 0.1118504
	speed: 0.0683s/iter; left time: 1356.3839s
	iters: 300, epoch: 3 | loss: 0.1085410
	speed: 0.0681s/iter; left time: 1345.7376s
	iters: 400, epoch: 3 | loss: 0.1406517
	speed: 0.0680s/iter; left time: 1335.4816s
	iters: 500, epoch: 3 | loss: 0.1080799
	speed: 0.0678s/iter; left time: 1324.4698s
	iters: 600, epoch: 3 | loss: 0.0931189
	speed: 0.0680s/iter; left time: 1321.7278s
	iters: 700, epoch: 3 | loss: 0.1191577
	speed: 0.0681s/iter; left time: 1317.3203s
Epoch: 3 cost time: 48.8409309387207
Epoch: 3, Steps: 716 | Train Loss: 0.1153604 Vali Loss: 0.1107612 Test Loss: 0.1878578
Validation loss decreased (0.151003 --> 0.110761).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1057173
	speed: 0.3021s/iter; left time: 5810.1860s
	iters: 200, epoch: 4 | loss: 0.0995041
	speed: 0.0676s/iter; left time: 1293.7788s
	iters: 300, epoch: 4 | loss: 0.1055508
	speed: 0.0686s/iter; left time: 1305.5766s
	iters: 400, epoch: 4 | loss: 0.0841094
	speed: 0.0679s/iter; left time: 1286.4262s
	iters: 500, epoch: 4 | loss: 0.0961472
	speed: 0.0682s/iter; left time: 1284.7740s
	iters: 600, epoch: 4 | loss: 0.0935043
	speed: 0.0681s/iter; left time: 1275.7994s
	iters: 700, epoch: 4 | loss: 0.0876652
	speed: 0.0677s/iter; left time: 1261.5724s
Epoch: 4 cost time: 48.750802516937256
Epoch: 4, Steps: 716 | Train Loss: 0.0963061 Vali Loss: 0.1024900 Test Loss: 0.1783789
Validation loss decreased (0.110761 --> 0.102490).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1004719
	speed: 0.3005s/iter; left time: 5563.5827s
	iters: 200, epoch: 5 | loss: 0.0913210
	speed: 0.0674s/iter; left time: 1240.8492s
	iters: 300, epoch: 5 | loss: 0.0981644
	speed: 0.0682s/iter; left time: 1249.9249s
	iters: 400, epoch: 5 | loss: 0.0881344
	speed: 0.0686s/iter; left time: 1250.3449s
	iters: 500, epoch: 5 | loss: 0.0839100
	speed: 0.0698s/iter; left time: 1263.9110s
	iters: 600, epoch: 5 | loss: 0.0819322
	speed: 0.0702s/iter; left time: 1264.7739s
	iters: 700, epoch: 5 | loss: 0.0867408
	speed: 0.0692s/iter; left time: 1239.7635s
Epoch: 5 cost time: 49.3570716381073
Epoch: 5, Steps: 716 | Train Loss: 0.0869822 Vali Loss: 0.0982609 Test Loss: 0.1712369
Validation loss decreased (0.102490 --> 0.098261).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0871281
	speed: 0.3030s/iter; left time: 5393.8583s
	iters: 200, epoch: 6 | loss: 0.1037854
	speed: 0.0677s/iter; left time: 1199.0035s
	iters: 300, epoch: 6 | loss: 0.0802223
	speed: 0.0684s/iter; left time: 1203.5050s
	iters: 400, epoch: 6 | loss: 0.0897763
	speed: 0.0685s/iter; left time: 1198.7354s
	iters: 500, epoch: 6 | loss: 0.0901624
	speed: 0.0683s/iter; left time: 1188.0271s
	iters: 600, epoch: 6 | loss: 0.0919576
	speed: 0.0687s/iter; left time: 1188.0269s
	iters: 700, epoch: 6 | loss: 0.0784713
	speed: 0.0689s/iter; left time: 1185.3447s
Epoch: 6 cost time: 49.01598143577576
Epoch: 6, Steps: 716 | Train Loss: 0.0810686 Vali Loss: 0.0973660 Test Loss: 0.1730553
Validation loss decreased (0.098261 --> 0.097366).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0888200
	speed: 0.3020s/iter; left time: 5159.1949s
	iters: 200, epoch: 7 | loss: 0.0689145
	speed: 0.0665s/iter; left time: 1129.1564s
	iters: 300, epoch: 7 | loss: 0.0884222
	speed: 0.0669s/iter; left time: 1129.4508s
	iters: 400, epoch: 7 | loss: 0.0860233
	speed: 0.0681s/iter; left time: 1143.3662s
	iters: 500, epoch: 7 | loss: 0.0779652
	speed: 0.0675s/iter; left time: 1125.9709s
	iters: 600, epoch: 7 | loss: 0.0792969
	speed: 0.0681s/iter; left time: 1129.3515s
	iters: 700, epoch: 7 | loss: 0.0684336
	speed: 0.0680s/iter; left time: 1121.7705s
Epoch: 7 cost time: 48.27789759635925
Epoch: 7, Steps: 716 | Train Loss: 0.0771297 Vali Loss: 0.0946755 Test Loss: 0.1711360
Validation loss decreased (0.097366 --> 0.094676).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0724619
	speed: 0.3038s/iter; left time: 4972.6292s
	iters: 200, epoch: 8 | loss: 0.0683287
	speed: 0.0679s/iter; left time: 1104.4967s
	iters: 300, epoch: 8 | loss: 0.0762654
	speed: 0.0676s/iter; left time: 1093.4753s
	iters: 400, epoch: 8 | loss: 0.0763307
	speed: 0.0683s/iter; left time: 1097.0205s
	iters: 500, epoch: 8 | loss: 0.0765531
	speed: 0.0688s/iter; left time: 1098.0399s
	iters: 600, epoch: 8 | loss: 0.0844042
	speed: 0.0688s/iter; left time: 1092.1273s
	iters: 700, epoch: 8 | loss: 0.0787510
	speed: 0.0685s/iter; left time: 1080.6896s
Epoch: 8 cost time: 49.08796453475952
Epoch: 8, Steps: 716 | Train Loss: 0.0741476 Vali Loss: 0.0928552 Test Loss: 0.1699958
Validation loss decreased (0.094676 --> 0.092855).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0551315
	speed: 0.3033s/iter; left time: 4747.9530s
	iters: 200, epoch: 9 | loss: 0.0679489
	speed: 0.0677s/iter; left time: 1052.6875s
	iters: 300, epoch: 9 | loss: 0.0773834
	speed: 0.0684s/iter; left time: 1057.0024s
	iters: 400, epoch: 9 | loss: 0.0722335
	speed: 0.0686s/iter; left time: 1053.5458s
	iters: 500, epoch: 9 | loss: 0.0660477
	speed: 0.0681s/iter; left time: 1038.4547s
	iters: 600, epoch: 9 | loss: 0.0776533
	speed: 0.0687s/iter; left time: 1040.3793s
	iters: 700, epoch: 9 | loss: 0.0670063
	speed: 0.0683s/iter; left time: 1027.9251s
Epoch: 9 cost time: 48.92242217063904
Epoch: 9, Steps: 716 | Train Loss: 0.0719904 Vali Loss: 0.0939813 Test Loss: 0.1712451
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0874184
	speed: 0.3038s/iter; left time: 4537.8053s
	iters: 200, epoch: 10 | loss: 0.0751062
	speed: 0.0691s/iter; left time: 1024.8807s
	iters: 300, epoch: 10 | loss: 0.0678072
	speed: 0.0690s/iter; left time: 1017.2679s
	iters: 400, epoch: 10 | loss: 0.0730145
	speed: 0.0698s/iter; left time: 1021.8738s
	iters: 500, epoch: 10 | loss: 0.0659759
	speed: 0.0687s/iter; left time: 998.1540s
	iters: 600, epoch: 10 | loss: 0.0661360
	speed: 0.0689s/iter; left time: 994.4755s
	iters: 700, epoch: 10 | loss: 0.0628665
	speed: 0.0691s/iter; left time: 990.4003s
Epoch: 10 cost time: 49.51175880432129
Epoch: 10, Steps: 716 | Train Loss: 0.0704659 Vali Loss: 0.0936236 Test Loss: 0.1715195
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0599777
	speed: 0.3008s/iter; left time: 4278.1339s
	iters: 200, epoch: 11 | loss: 0.0589736
	speed: 0.0678s/iter; left time: 957.0927s
	iters: 300, epoch: 11 | loss: 0.0770772
	speed: 0.0679s/iter; left time: 952.0946s
	iters: 400, epoch: 11 | loss: 0.0654141
	speed: 0.0679s/iter; left time: 945.1543s
	iters: 500, epoch: 11 | loss: 0.0638443
	speed: 0.0688s/iter; left time: 950.6665s
	iters: 600, epoch: 11 | loss: 0.0777581
	speed: 0.0681s/iter; left time: 933.8552s
	iters: 700, epoch: 11 | loss: 0.0750066
	speed: 0.0678s/iter; left time: 923.3173s
Epoch: 11 cost time: 48.691954374313354
Epoch: 11, Steps: 716 | Train Loss: 0.0691964 Vali Loss: 0.0898631 Test Loss: 0.1651590
Validation loss decreased (0.092855 --> 0.089863).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0694686
	speed: 0.3014s/iter; left time: 4069.8927s
	iters: 200, epoch: 12 | loss: 0.0664841
	speed: 0.0684s/iter; left time: 916.6296s
	iters: 300, epoch: 12 | loss: 0.0624818
	speed: 0.0697s/iter; left time: 926.7114s
	iters: 400, epoch: 12 | loss: 0.0843472
	speed: 0.0695s/iter; left time: 917.6119s
	iters: 500, epoch: 12 | loss: 0.0680526
	speed: 0.0700s/iter; left time: 916.8877s
	iters: 600, epoch: 12 | loss: 0.0700906
	speed: 0.0695s/iter; left time: 904.3989s
	iters: 700, epoch: 12 | loss: 0.0624941
	speed: 0.0685s/iter; left time: 884.2988s
Epoch: 12 cost time: 49.49542260169983
Epoch: 12, Steps: 716 | Train Loss: 0.0680289 Vali Loss: 0.0901451 Test Loss: 0.1655831
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0638202
	speed: 0.3029s/iter; left time: 3873.4317s
	iters: 200, epoch: 13 | loss: 0.0698700
	speed: 0.0692s/iter; left time: 877.6739s
	iters: 300, epoch: 13 | loss: 0.0612822
	speed: 0.0687s/iter; left time: 864.5263s
	iters: 400, epoch: 13 | loss: 0.0596372
	speed: 0.0702s/iter; left time: 876.3212s
	iters: 500, epoch: 13 | loss: 0.0565267
	speed: 0.0685s/iter; left time: 848.3142s
	iters: 600, epoch: 13 | loss: 0.0570423
	speed: 0.0697s/iter; left time: 857.0397s
	iters: 700, epoch: 13 | loss: 0.0534490
	speed: 0.0690s/iter; left time: 840.6539s
Epoch: 13 cost time: 49.54852914810181
Epoch: 13, Steps: 716 | Train Loss: 0.0671936 Vali Loss: 0.0913447 Test Loss: 0.1692727
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0674171
	speed: 0.3065s/iter; left time: 3699.8227s
	iters: 200, epoch: 14 | loss: 0.0661949
	speed: 0.0685s/iter; left time: 819.8042s
	iters: 300, epoch: 14 | loss: 0.0781455
	speed: 0.0693s/iter; left time: 822.8998s
	iters: 400, epoch: 14 | loss: 0.0577734
	speed: 0.0694s/iter; left time: 816.9443s
	iters: 500, epoch: 14 | loss: 0.0672136
	speed: 0.0695s/iter; left time: 811.6081s
	iters: 600, epoch: 14 | loss: 0.0574214
	speed: 0.0688s/iter; left time: 795.8816s
	iters: 700, epoch: 14 | loss: 0.0788048
	speed: 0.0678s/iter; left time: 778.2955s
Epoch: 14 cost time: 49.29709005355835
Epoch: 14, Steps: 716 | Train Loss: 0.0663720 Vali Loss: 0.0893371 Test Loss: 0.1660281
Validation loss decreased (0.089863 --> 0.089337).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0646570
	speed: 0.3019s/iter; left time: 3428.3912s
	iters: 200, epoch: 15 | loss: 0.0575721
	speed: 0.0683s/iter; left time: 768.6756s
	iters: 300, epoch: 15 | loss: 0.0813493
	speed: 0.0686s/iter; left time: 764.8168s
	iters: 400, epoch: 15 | loss: 0.0735978
	speed: 0.0673s/iter; left time: 743.9918s
	iters: 500, epoch: 15 | loss: 0.0667472
	speed: 0.0686s/iter; left time: 751.8297s
	iters: 600, epoch: 15 | loss: 0.0665863
	speed: 0.0696s/iter; left time: 755.2279s
	iters: 700, epoch: 15 | loss: 0.0685072
	speed: 0.0688s/iter; left time: 740.1232s
Epoch: 15 cost time: 49.31930661201477
Epoch: 15, Steps: 716 | Train Loss: 0.0657729 Vali Loss: 0.0894060 Test Loss: 0.1672921
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0584839
	speed: 0.3038s/iter; left time: 3232.2139s
	iters: 200, epoch: 16 | loss: 0.0511324
	speed: 0.0675s/iter; left time: 711.9252s
	iters: 300, epoch: 16 | loss: 0.0711237
	speed: 0.0698s/iter; left time: 729.2995s
	iters: 400, epoch: 16 | loss: 0.0593434
	speed: 0.0689s/iter; left time: 712.4732s
	iters: 500, epoch: 16 | loss: 0.0637249
	speed: 0.0693s/iter; left time: 709.9981s
	iters: 600, epoch: 16 | loss: 0.0715152
	speed: 0.0705s/iter; left time: 714.8840s
	iters: 700, epoch: 16 | loss: 0.0772175
	speed: 0.0692s/iter; left time: 695.3061s
Epoch: 16 cost time: 49.7184898853302
Epoch: 16, Steps: 716 | Train Loss: 0.0652175 Vali Loss: 0.0883819 Test Loss: 0.1643368
Validation loss decreased (0.089337 --> 0.088382).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0761617
	speed: 0.3075s/iter; left time: 3051.7253s
	iters: 200, epoch: 17 | loss: 0.0736165
	speed: 0.0673s/iter; left time: 661.1131s
	iters: 300, epoch: 17 | loss: 0.0662085
	speed: 0.0672s/iter; left time: 653.6269s
	iters: 400, epoch: 17 | loss: 0.0639488
	speed: 0.0681s/iter; left time: 655.8961s
	iters: 500, epoch: 17 | loss: 0.0725634
	speed: 0.0681s/iter; left time: 649.1149s
	iters: 600, epoch: 17 | loss: 0.0724820
	speed: 0.0687s/iter; left time: 647.7750s
	iters: 700, epoch: 17 | loss: 0.0680233
	speed: 0.0695s/iter; left time: 648.4135s
Epoch: 17 cost time: 48.9125542640686
Epoch: 17, Steps: 716 | Train Loss: 0.0646821 Vali Loss: 0.0893742 Test Loss: 0.1670546
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0664935
	speed: 0.3031s/iter; left time: 2791.2024s
	iters: 200, epoch: 18 | loss: 0.0535704
	speed: 0.0699s/iter; left time: 636.5908s
	iters: 300, epoch: 18 | loss: 0.0609395
	speed: 0.0690s/iter; left time: 621.2062s
	iters: 400, epoch: 18 | loss: 0.0506443
	speed: 0.0698s/iter; left time: 621.4960s
	iters: 500, epoch: 18 | loss: 0.0666816
	speed: 0.0688s/iter; left time: 605.6545s
	iters: 600, epoch: 18 | loss: 0.0646196
	speed: 0.0691s/iter; left time: 601.6632s
	iters: 700, epoch: 18 | loss: 0.0677026
	speed: 0.0697s/iter; left time: 600.0614s
Epoch: 18 cost time: 49.67706894874573
Epoch: 18, Steps: 716 | Train Loss: 0.0643891 Vali Loss: 0.0895846 Test Loss: 0.1675907
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0686029
	speed: 0.3038s/iter; left time: 2580.4786s
	iters: 200, epoch: 19 | loss: 0.0610192
	speed: 0.0689s/iter; left time: 578.4821s
	iters: 300, epoch: 19 | loss: 0.0617191
	speed: 0.0695s/iter; left time: 576.5361s
	iters: 400, epoch: 19 | loss: 0.0531355
	speed: 0.0706s/iter; left time: 578.6510s
	iters: 500, epoch: 19 | loss: 0.0555612
	speed: 0.0700s/iter; left time: 566.8953s
	iters: 600, epoch: 19 | loss: 0.0534396
	speed: 0.0695s/iter; left time: 555.6642s
	iters: 700, epoch: 19 | loss: 0.0629214
	speed: 0.0709s/iter; left time: 559.5720s
Epoch: 19 cost time: 49.95696783065796
Epoch: 19, Steps: 716 | Train Loss: 0.0640462 Vali Loss: 0.0884859 Test Loss: 0.1656788
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_96_720_MLPAer_univariate_custom_ftMS_sl96_ll48_pl720_dm2048_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.16433683037757874, mae:0.24479858577251434, rse:0.30175843834877014
