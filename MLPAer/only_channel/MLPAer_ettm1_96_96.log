Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='ETTm1_96_96', model='MLPAer_only_channel', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.05, head_dropout=0.5, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=21, t_ff=256, c_dropout=0.0, t_dropout=0.0, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_MLPAer_only_channel_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4013370
	speed: 0.0352s/iter; left time: 1130.6017s
	iters: 200, epoch: 1 | loss: 0.4292163
	speed: 0.0166s/iter; left time: 531.5780s
	iters: 300, epoch: 1 | loss: 0.5157845
	speed: 0.0160s/iter; left time: 511.4260s
	iters: 400, epoch: 1 | loss: 0.4937294
	speed: 0.0162s/iter; left time: 515.0083s
	iters: 500, epoch: 1 | loss: 0.5298515
	speed: 0.0163s/iter; left time: 517.0352s
	iters: 600, epoch: 1 | loss: 0.4958566
	speed: 0.0162s/iter; left time: 513.6850s
	iters: 700, epoch: 1 | loss: 0.4013388
	speed: 0.0161s/iter; left time: 508.1801s
	iters: 800, epoch: 1 | loss: 0.5651802
	speed: 0.0163s/iter; left time: 511.8908s
	iters: 900, epoch: 1 | loss: 0.4126421
	speed: 0.0162s/iter; left time: 505.9098s
	iters: 1000, epoch: 1 | loss: 0.4212112
	speed: 0.0158s/iter; left time: 492.0649s
Epoch: 1 cost time: 17.773648262023926
Epoch: 1, Steps: 1074 | Train Loss: 0.4816622 Vali Loss: 0.7087030 Test Loss: 0.6286553
Validation loss decreased (inf --> 0.708703).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4389028
	speed: 0.0655s/iter; left time: 2034.1827s
	iters: 200, epoch: 2 | loss: 0.3546957
	speed: 0.0164s/iter; left time: 506.4733s
	iters: 300, epoch: 2 | loss: 0.3199284
	speed: 0.0166s/iter; left time: 511.2595s
	iters: 400, epoch: 2 | loss: 0.3881972
	speed: 0.0164s/iter; left time: 503.5868s
	iters: 500, epoch: 2 | loss: 0.3719220
	speed: 0.0166s/iter; left time: 507.9973s
	iters: 600, epoch: 2 | loss: 0.2696345
	speed: 0.0166s/iter; left time: 506.6498s
	iters: 700, epoch: 2 | loss: 0.2914665
	speed: 0.0166s/iter; left time: 506.8543s
	iters: 800, epoch: 2 | loss: 0.2929753
	speed: 0.0166s/iter; left time: 502.3883s
	iters: 900, epoch: 2 | loss: 0.3412731
	speed: 0.0164s/iter; left time: 497.2784s
	iters: 1000, epoch: 2 | loss: 0.3642360
	speed: 0.0167s/iter; left time: 504.5346s
Epoch: 2 cost time: 17.880931854248047
Epoch: 2, Steps: 1074 | Train Loss: 0.3518029 Vali Loss: 0.3976497 Test Loss: 0.3428998
Validation loss decreased (0.708703 --> 0.397650).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3140607
	speed: 0.0686s/iter; left time: 2056.0750s
	iters: 200, epoch: 3 | loss: 0.2705845
	speed: 0.0165s/iter; left time: 491.8692s
	iters: 300, epoch: 3 | loss: 0.3698813
	speed: 0.0165s/iter; left time: 489.8167s
	iters: 400, epoch: 3 | loss: 0.3190885
	speed: 0.0165s/iter; left time: 488.9639s
	iters: 500, epoch: 3 | loss: 0.3066807
	speed: 0.0166s/iter; left time: 491.5425s
	iters: 600, epoch: 3 | loss: 0.2696438
	speed: 0.0167s/iter; left time: 491.0454s
	iters: 700, epoch: 3 | loss: 0.3455710
	speed: 0.0167s/iter; left time: 490.0831s
	iters: 800, epoch: 3 | loss: 0.2414781
	speed: 0.0167s/iter; left time: 490.0287s
	iters: 900, epoch: 3 | loss: 0.4498930
	speed: 0.0168s/iter; left time: 489.1179s
	iters: 1000, epoch: 3 | loss: 0.3587987
	speed: 0.0168s/iter; left time: 489.1060s
Epoch: 3 cost time: 18.032171487808228
Epoch: 3, Steps: 1074 | Train Loss: 0.3147803 Vali Loss: 0.3959105 Test Loss: 0.3319046
Validation loss decreased (0.397650 --> 0.395911).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2989315
	speed: 0.0663s/iter; left time: 1917.3197s
	iters: 200, epoch: 4 | loss: 0.3177444
	speed: 0.0156s/iter; left time: 449.4333s
	iters: 300, epoch: 4 | loss: 0.3421633
	speed: 0.0153s/iter; left time: 438.7652s
	iters: 400, epoch: 4 | loss: 0.2660617
	speed: 0.0155s/iter; left time: 444.5313s
	iters: 500, epoch: 4 | loss: 0.2827183
	speed: 0.0158s/iter; left time: 449.6861s
	iters: 600, epoch: 4 | loss: 0.3447577
	speed: 0.0157s/iter; left time: 445.4174s
	iters: 700, epoch: 4 | loss: 0.2212730
	speed: 0.0156s/iter; left time: 442.0211s
	iters: 800, epoch: 4 | loss: 0.2687734
	speed: 0.0156s/iter; left time: 441.1436s
	iters: 900, epoch: 4 | loss: 0.3327042
	speed: 0.0156s/iter; left time: 437.1023s
	iters: 1000, epoch: 4 | loss: 0.2693320
	speed: 0.0157s/iter; left time: 438.9800s
Epoch: 4 cost time: 17.005369901657104
Epoch: 4, Steps: 1074 | Train Loss: 0.3009391 Vali Loss: 0.3913742 Test Loss: 0.3279977
Validation loss decreased (0.395911 --> 0.391374).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2165231
	speed: 0.0684s/iter; left time: 1903.9132s
	iters: 200, epoch: 5 | loss: 0.3167173
	speed: 0.0161s/iter; left time: 447.7045s
	iters: 300, epoch: 5 | loss: 0.2628529
	speed: 0.0164s/iter; left time: 452.7870s
	iters: 400, epoch: 5 | loss: 0.3231159
	speed: 0.0161s/iter; left time: 444.0362s
	iters: 500, epoch: 5 | loss: 0.2697397
	speed: 0.0161s/iter; left time: 441.6441s
	iters: 600, epoch: 5 | loss: 0.2593696
	speed: 0.0160s/iter; left time: 436.8482s
	iters: 700, epoch: 5 | loss: 0.3420328
	speed: 0.0158s/iter; left time: 431.1645s
	iters: 800, epoch: 5 | loss: 0.3141862
	speed: 0.0158s/iter; left time: 427.8230s
	iters: 900, epoch: 5 | loss: 0.2336208
	speed: 0.0158s/iter; left time: 426.8625s
	iters: 1000, epoch: 5 | loss: 0.2542898
	speed: 0.0158s/iter; left time: 426.6260s
Epoch: 5 cost time: 17.412089586257935
Epoch: 5, Steps: 1074 | Train Loss: 0.2915309 Vali Loss: 0.3868130 Test Loss: 0.3254908
Validation loss decreased (0.391374 --> 0.386813).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2680761
	speed: 0.0684s/iter; left time: 1830.2503s
	iters: 200, epoch: 6 | loss: 0.2531970
	speed: 0.0165s/iter; left time: 439.5996s
	iters: 300, epoch: 6 | loss: 0.3218778
	speed: 0.0165s/iter; left time: 437.4529s
	iters: 400, epoch: 6 | loss: 0.2876962
	speed: 0.0166s/iter; left time: 437.7859s
	iters: 500, epoch: 6 | loss: 0.2728632
	speed: 0.0166s/iter; left time: 436.1448s
	iters: 600, epoch: 6 | loss: 0.2900859
	speed: 0.0164s/iter; left time: 431.3015s
	iters: 700, epoch: 6 | loss: 0.3006315
	speed: 0.0165s/iter; left time: 432.4254s
	iters: 800, epoch: 6 | loss: 0.3082829
	speed: 0.0165s/iter; left time: 429.4474s
	iters: 900, epoch: 6 | loss: 0.2963266
	speed: 0.0164s/iter; left time: 426.8475s
	iters: 1000, epoch: 6 | loss: 0.2711428
	speed: 0.0165s/iter; left time: 425.3926s
Epoch: 6 cost time: 17.881962776184082
Epoch: 6, Steps: 1074 | Train Loss: 0.2854997 Vali Loss: 0.3908730 Test Loss: 0.3252333
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2793921
	speed: 0.0662s/iter; left time: 1701.0933s
	iters: 200, epoch: 7 | loss: 0.2744555
	speed: 0.0166s/iter; left time: 423.3858s
	iters: 300, epoch: 7 | loss: 0.2800348
	speed: 0.0165s/iter; left time: 419.2161s
	iters: 400, epoch: 7 | loss: 0.2568198
	speed: 0.0166s/iter; left time: 420.3882s
	iters: 500, epoch: 7 | loss: 0.3032813
	speed: 0.0166s/iter; left time: 418.7167s
	iters: 600, epoch: 7 | loss: 0.2434850
	speed: 0.0164s/iter; left time: 413.4794s
	iters: 700, epoch: 7 | loss: 0.2433625
	speed: 0.0164s/iter; left time: 411.6780s
	iters: 800, epoch: 7 | loss: 0.3373015
	speed: 0.0166s/iter; left time: 413.4619s
	iters: 900, epoch: 7 | loss: 0.2655770
	speed: 0.0165s/iter; left time: 410.9499s
	iters: 1000, epoch: 7 | loss: 0.3174603
	speed: 0.0163s/iter; left time: 404.6779s
Epoch: 7 cost time: 17.796485662460327
Epoch: 7, Steps: 1074 | Train Loss: 0.2811417 Vali Loss: 0.3894921 Test Loss: 0.3242191
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2892372
	speed: 0.0652s/iter; left time: 1603.3324s
	iters: 200, epoch: 8 | loss: 0.2470985
	speed: 0.0164s/iter; left time: 402.0807s
	iters: 300, epoch: 8 | loss: 0.2660393
	speed: 0.0164s/iter; left time: 399.7007s
	iters: 400, epoch: 8 | loss: 0.2594911
	speed: 0.0164s/iter; left time: 398.2458s
	iters: 500, epoch: 8 | loss: 0.2891456
	speed: 0.0164s/iter; left time: 397.2917s
	iters: 600, epoch: 8 | loss: 0.2760098
	speed: 0.0164s/iter; left time: 395.1500s
	iters: 700, epoch: 8 | loss: 0.2552795
	speed: 0.0165s/iter; left time: 396.1734s
	iters: 800, epoch: 8 | loss: 0.2692263
	speed: 0.0165s/iter; left time: 394.9806s
	iters: 900, epoch: 8 | loss: 0.2874776
	speed: 0.0166s/iter; left time: 395.2448s
	iters: 1000, epoch: 8 | loss: 0.2655191
	speed: 0.0164s/iter; left time: 388.4681s
Epoch: 8 cost time: 17.814249277114868
Epoch: 8, Steps: 1074 | Train Loss: 0.2783438 Vali Loss: 0.3874034 Test Loss: 0.3235598
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3032443
	speed: 0.0667s/iter; left time: 1569.7630s
	iters: 200, epoch: 9 | loss: 0.2735596
	speed: 0.0162s/iter; left time: 378.7425s
	iters: 300, epoch: 9 | loss: 0.2624539
	speed: 0.0163s/iter; left time: 379.7472s
	iters: 400, epoch: 9 | loss: 0.2419502
	speed: 0.0161s/iter; left time: 374.7393s
	iters: 500, epoch: 9 | loss: 0.2182041
	speed: 0.0161s/iter; left time: 371.5987s
	iters: 600, epoch: 9 | loss: 0.2570672
	speed: 0.0158s/iter; left time: 362.7368s
	iters: 700, epoch: 9 | loss: 0.2619512
	speed: 0.0159s/iter; left time: 363.5408s
	iters: 800, epoch: 9 | loss: 0.3073347
	speed: 0.0158s/iter; left time: 359.9961s
	iters: 900, epoch: 9 | loss: 0.2467052
	speed: 0.0160s/iter; left time: 363.3069s
	iters: 1000, epoch: 9 | loss: 0.2943551
	speed: 0.0160s/iter; left time: 361.6377s
Epoch: 9 cost time: 17.34131908416748
Epoch: 9, Steps: 1074 | Train Loss: 0.2761982 Vali Loss: 0.3893540 Test Loss: 0.3219466
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2740785
	speed: 0.0667s/iter; left time: 1496.6600s
	iters: 200, epoch: 10 | loss: 0.2585925
	speed: 0.0164s/iter; left time: 366.5775s
	iters: 300, epoch: 10 | loss: 0.2296745
	speed: 0.0162s/iter; left time: 360.8829s
	iters: 400, epoch: 10 | loss: 0.2552894
	speed: 0.0164s/iter; left time: 362.3521s
	iters: 500, epoch: 10 | loss: 0.2675386
	speed: 0.0160s/iter; left time: 352.4421s
	iters: 600, epoch: 10 | loss: 0.3515816
	speed: 0.0164s/iter; left time: 359.9169s
	iters: 700, epoch: 10 | loss: 0.2776490
	speed: 0.0164s/iter; left time: 357.4568s
	iters: 800, epoch: 10 | loss: 0.2300382
	speed: 0.0162s/iter; left time: 353.4255s
	iters: 900, epoch: 10 | loss: 0.2456874
	speed: 0.0162s/iter; left time: 350.2408s
	iters: 1000, epoch: 10 | loss: 0.2668597
	speed: 0.0164s/iter; left time: 353.1254s
Epoch: 10 cost time: 17.68053412437439
Epoch: 10, Steps: 1074 | Train Loss: 0.2740696 Vali Loss: 0.3881077 Test Loss: 0.3230135
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_96_96_MLPAer_only_channel_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.32549068331718445, mae:0.3641205430030823, rse:0.5428725481033325
