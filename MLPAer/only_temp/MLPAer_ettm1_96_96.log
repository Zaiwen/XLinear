Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='ETTm1_96_96', model='MLPAer_only_temp', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.05, head_dropout=0.5, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=21, t_ff=256, c_dropout=0.0, t_dropout=0.0, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_MLPAer_only_temp_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4285501
	speed: 0.0294s/iter; left time: 942.7701s
	iters: 200, epoch: 1 | loss: 0.5910814
	speed: 0.0096s/iter; left time: 307.3133s
	iters: 300, epoch: 1 | loss: 0.4484217
	speed: 0.0096s/iter; left time: 307.0412s
	iters: 400, epoch: 1 | loss: 0.4315964
	speed: 0.0093s/iter; left time: 295.9841s
	iters: 500, epoch: 1 | loss: 0.4574446
	speed: 0.0092s/iter; left time: 291.1426s
	iters: 600, epoch: 1 | loss: 0.5461166
	speed: 0.0092s/iter; left time: 291.1430s
	iters: 700, epoch: 1 | loss: 0.4145302
	speed: 0.0091s/iter; left time: 286.8625s
	iters: 800, epoch: 1 | loss: 0.4502531
	speed: 0.0092s/iter; left time: 288.6484s
	iters: 900, epoch: 1 | loss: 0.4327157
	speed: 0.0091s/iter; left time: 283.5151s
	iters: 1000, epoch: 1 | loss: 0.3928537
	speed: 0.0091s/iter; left time: 285.1395s
Epoch: 1 cost time: 10.430155992507935
Epoch: 1, Steps: 1074 | Train Loss: 0.4674548 Vali Loss: 0.5969712 Test Loss: 0.5345505
Validation loss decreased (inf --> 0.596971).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4634850
	speed: 0.0513s/iter; left time: 1593.0225s
	iters: 200, epoch: 2 | loss: 0.4143312
	speed: 0.0091s/iter; left time: 280.9149s
	iters: 300, epoch: 2 | loss: 0.4068867
	speed: 0.0091s/iter; left time: 279.2638s
	iters: 400, epoch: 2 | loss: 0.4415253
	speed: 0.0090s/iter; left time: 278.2075s
	iters: 500, epoch: 2 | loss: 0.3067279
	speed: 0.0092s/iter; left time: 283.1616s
	iters: 600, epoch: 2 | loss: 0.3094061
	speed: 0.0091s/iter; left time: 277.9079s
	iters: 700, epoch: 2 | loss: 0.2973966
	speed: 0.0090s/iter; left time: 274.5181s
	iters: 800, epoch: 2 | loss: 0.3329554
	speed: 0.0090s/iter; left time: 273.9928s
	iters: 900, epoch: 2 | loss: 0.2979893
	speed: 0.0090s/iter; left time: 272.2062s
	iters: 1000, epoch: 2 | loss: 0.4291551
	speed: 0.0090s/iter; left time: 272.4519s
Epoch: 2 cost time: 9.963064908981323
Epoch: 2, Steps: 1074 | Train Loss: 0.3485313 Vali Loss: 0.4064380 Test Loss: 0.3386155
Validation loss decreased (0.596971 --> 0.406438).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3615752
	speed: 0.0524s/iter; left time: 1570.2821s
	iters: 200, epoch: 3 | loss: 0.2797906
	speed: 0.0093s/iter; left time: 278.3678s
	iters: 300, epoch: 3 | loss: 0.3235792
	speed: 0.0094s/iter; left time: 279.0972s
	iters: 400, epoch: 3 | loss: 0.3112693
	speed: 0.0094s/iter; left time: 278.9682s
	iters: 500, epoch: 3 | loss: 0.3192996
	speed: 0.0096s/iter; left time: 282.5191s
	iters: 600, epoch: 3 | loss: 0.4011789
	speed: 0.0093s/iter; left time: 275.4780s
	iters: 700, epoch: 3 | loss: 0.3927412
	speed: 0.0097s/iter; left time: 284.5712s
	iters: 800, epoch: 3 | loss: 0.3326692
	speed: 0.0100s/iter; left time: 292.2967s
	iters: 900, epoch: 3 | loss: 0.2810255
	speed: 0.0094s/iter; left time: 274.2252s
	iters: 1000, epoch: 3 | loss: 0.3717305
	speed: 0.0094s/iter; left time: 272.4731s
Epoch: 3 cost time: 10.44856333732605
Epoch: 3, Steps: 1074 | Train Loss: 0.3166849 Vali Loss: 0.4002729 Test Loss: 0.3298736
Validation loss decreased (0.406438 --> 0.400273).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3137991
	speed: 0.0528s/iter; left time: 1525.7235s
	iters: 200, epoch: 4 | loss: 0.2936334
	speed: 0.0092s/iter; left time: 264.6940s
	iters: 300, epoch: 4 | loss: 0.3177812
	speed: 0.0092s/iter; left time: 263.5080s
	iters: 400, epoch: 4 | loss: 0.2806644
	speed: 0.0092s/iter; left time: 264.2629s
	iters: 500, epoch: 4 | loss: 0.3267973
	speed: 0.0095s/iter; left time: 269.7147s
	iters: 600, epoch: 4 | loss: 0.3151754
	speed: 0.0094s/iter; left time: 266.4205s
	iters: 700, epoch: 4 | loss: 0.2584060
	speed: 0.0093s/iter; left time: 263.3860s
	iters: 800, epoch: 4 | loss: 0.3102328
	speed: 0.0093s/iter; left time: 262.6300s
	iters: 900, epoch: 4 | loss: 0.2569242
	speed: 0.0092s/iter; left time: 257.6345s
	iters: 1000, epoch: 4 | loss: 0.3951947
	speed: 0.0091s/iter; left time: 255.1792s
Epoch: 4 cost time: 10.137367248535156
Epoch: 4, Steps: 1074 | Train Loss: 0.3050800 Vali Loss: 0.3991467 Test Loss: 0.3278798
Validation loss decreased (0.400273 --> 0.399147).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3202499
	speed: 0.0516s/iter; left time: 1434.9854s
	iters: 200, epoch: 5 | loss: 0.3419435
	speed: 0.0093s/iter; left time: 258.2504s
	iters: 300, epoch: 5 | loss: 0.3669551
	speed: 0.0094s/iter; left time: 259.1839s
	iters: 400, epoch: 5 | loss: 0.3546316
	speed: 0.0105s/iter; left time: 288.7183s
	iters: 500, epoch: 5 | loss: 0.2826021
	speed: 0.0101s/iter; left time: 276.9629s
	iters: 600, epoch: 5 | loss: 0.3167727
	speed: 0.0094s/iter; left time: 255.5524s
	iters: 700, epoch: 5 | loss: 0.3397260
	speed: 0.0094s/iter; left time: 254.7650s
	iters: 800, epoch: 5 | loss: 0.2698610
	speed: 0.0093s/iter; left time: 252.9519s
	iters: 900, epoch: 5 | loss: 0.3135687
	speed: 0.0093s/iter; left time: 252.4652s
	iters: 1000, epoch: 5 | loss: 0.3185079
	speed: 0.0093s/iter; left time: 251.7311s
Epoch: 5 cost time: 10.448450326919556
Epoch: 5, Steps: 1074 | Train Loss: 0.2977262 Vali Loss: 0.4013559 Test Loss: 0.3251740
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3861267
	speed: 0.0518s/iter; left time: 1385.4016s
	iters: 200, epoch: 6 | loss: 0.3436821
	speed: 0.0093s/iter; left time: 246.7683s
	iters: 300, epoch: 6 | loss: 0.2607465
	speed: 0.0093s/iter; left time: 246.8704s
	iters: 400, epoch: 6 | loss: 0.2312022
	speed: 0.0094s/iter; left time: 249.9533s
	iters: 500, epoch: 6 | loss: 0.2978318
	speed: 0.0094s/iter; left time: 246.8631s
	iters: 600, epoch: 6 | loss: 0.2868527
	speed: 0.0093s/iter; left time: 244.1483s
	iters: 700, epoch: 6 | loss: 0.2828892
	speed: 0.0093s/iter; left time: 242.8811s
	iters: 800, epoch: 6 | loss: 0.2550663
	speed: 0.0092s/iter; left time: 239.6577s
	iters: 900, epoch: 6 | loss: 0.2944973
	speed: 0.0091s/iter; left time: 235.9297s
	iters: 1000, epoch: 6 | loss: 0.2968926
	speed: 0.0099s/iter; left time: 255.3018s
Epoch: 6 cost time: 10.270720481872559
Epoch: 6, Steps: 1074 | Train Loss: 0.2929351 Vali Loss: 0.4012352 Test Loss: 0.3227929
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2962040
	speed: 0.0525s/iter; left time: 1348.4943s
	iters: 200, epoch: 7 | loss: 0.2738836
	speed: 0.0093s/iter; left time: 238.9795s
	iters: 300, epoch: 7 | loss: 0.2882398
	speed: 0.0093s/iter; left time: 237.0164s
	iters: 400, epoch: 7 | loss: 0.3146305
	speed: 0.0096s/iter; left time: 242.7645s
	iters: 500, epoch: 7 | loss: 0.2754495
	speed: 0.0094s/iter; left time: 237.9451s
	iters: 600, epoch: 7 | loss: 0.3120658
	speed: 0.0093s/iter; left time: 233.3858s
	iters: 700, epoch: 7 | loss: 0.2829632
	speed: 0.0093s/iter; left time: 232.6163s
	iters: 800, epoch: 7 | loss: 0.2350336
	speed: 0.0093s/iter; left time: 231.2978s
	iters: 900, epoch: 7 | loss: 0.2970636
	speed: 0.0092s/iter; left time: 229.7766s
	iters: 1000, epoch: 7 | loss: 0.2725553
	speed: 0.0092s/iter; left time: 229.0539s
Epoch: 7 cost time: 10.231117248535156
Epoch: 7, Steps: 1074 | Train Loss: 0.2900879 Vali Loss: 0.3994315 Test Loss: 0.3225057
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2804250
	speed: 0.0508s/iter; left time: 1250.4136s
	iters: 200, epoch: 8 | loss: 0.2917636
	speed: 0.0093s/iter; left time: 226.7998s
	iters: 300, epoch: 8 | loss: 0.2815802
	speed: 0.0093s/iter; left time: 226.9359s
	iters: 400, epoch: 8 | loss: 0.3106112
	speed: 0.0091s/iter; left time: 221.3724s
	iters: 500, epoch: 8 | loss: 0.3270167
	speed: 0.0093s/iter; left time: 226.1200s
	iters: 600, epoch: 8 | loss: 0.2526217
	speed: 0.0092s/iter; left time: 221.1373s
	iters: 700, epoch: 8 | loss: 0.2729218
	speed: 0.0091s/iter; left time: 219.1265s
	iters: 800, epoch: 8 | loss: 0.2909744
	speed: 0.0090s/iter; left time: 216.0624s
	iters: 900, epoch: 8 | loss: 0.2557908
	speed: 0.0091s/iter; left time: 217.7251s
	iters: 1000, epoch: 8 | loss: 0.3062864
	speed: 0.0090s/iter; left time: 213.2008s
Epoch: 8 cost time: 10.048535585403442
Epoch: 8, Steps: 1074 | Train Loss: 0.2877910 Vali Loss: 0.4020275 Test Loss: 0.3234589
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3551233
	speed: 0.0504s/iter; left time: 1184.8237s
	iters: 200, epoch: 9 | loss: 0.2851289
	speed: 0.0091s/iter; left time: 212.1309s
	iters: 300, epoch: 9 | loss: 0.2887368
	speed: 0.0091s/iter; left time: 211.7385s
	iters: 400, epoch: 9 | loss: 0.3149621
	speed: 0.0091s/iter; left time: 210.3932s
	iters: 500, epoch: 9 | loss: 0.2966815
	speed: 0.0090s/iter; left time: 208.8546s
	iters: 600, epoch: 9 | loss: 0.2202791
	speed: 0.0090s/iter; left time: 207.2232s
	iters: 700, epoch: 9 | loss: 0.2787183
	speed: 0.0090s/iter; left time: 207.3776s
	iters: 800, epoch: 9 | loss: 0.2931995
	speed: 0.0090s/iter; left time: 205.8324s
	iters: 900, epoch: 9 | loss: 0.3144774
	speed: 0.0090s/iter; left time: 204.2838s
	iters: 1000, epoch: 9 | loss: 0.2308031
	speed: 0.0090s/iter; left time: 204.3416s
Epoch: 9 cost time: 9.94355034828186
Epoch: 9, Steps: 1074 | Train Loss: 0.2860559 Vali Loss: 0.3999777 Test Loss: 0.3206489
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_96_96_MLPAer_only_temp_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.32787981629371643, mae:0.36601951718330383, rse:0.5448612570762634
