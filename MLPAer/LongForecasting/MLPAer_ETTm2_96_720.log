Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='ETTm2_96_720', model='MLPAer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, fc_dropout=0.05, head_dropout=0.4, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=15, batch_size=32, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=7, t_ff=256, c_dropout=0.1, t_dropout=0.2, embed_dropout=0.2, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_720_MLPAer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.3212830
	speed: 0.1215s/iter; left time: 1908.7395s
	iters: 200, epoch: 1 | loss: 1.0129795
	speed: 0.0745s/iter; left time: 1163.6077s
	iters: 300, epoch: 1 | loss: 0.6224325
	speed: 0.0699s/iter; left time: 1083.8942s
	iters: 400, epoch: 1 | loss: 0.4882050
	speed: 0.0628s/iter; left time: 967.7812s
	iters: 500, epoch: 1 | loss: 0.3310833
	speed: 0.0629s/iter; left time: 963.2013s
	iters: 600, epoch: 1 | loss: 0.8839424
	speed: 0.0625s/iter; left time: 950.3675s
	iters: 700, epoch: 1 | loss: 0.3920061
	speed: 0.0633s/iter; left time: 956.6437s
	iters: 800, epoch: 1 | loss: 0.5977886
	speed: 0.0744s/iter; left time: 1116.7230s
	iters: 900, epoch: 1 | loss: 0.9796134
	speed: 0.0757s/iter; left time: 1129.0675s
	iters: 1000, epoch: 1 | loss: 0.6943769
	speed: 0.0743s/iter; left time: 1100.1068s
Epoch: 1 cost time: 74.06000232696533
Epoch: 1, Steps: 1054 | Train Loss: 0.6174204 Vali Loss: 0.3038720 Test Loss: 0.4255452
Validation loss decreased (inf --> 0.303872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.1205375
	speed: 1.7201s/iter; left time: 25212.2317s
	iters: 200, epoch: 2 | loss: 0.5610415
	speed: 0.0782s/iter; left time: 1138.6219s
	iters: 300, epoch: 2 | loss: 0.8495889
	speed: 0.0736s/iter; left time: 1063.3784s
	iters: 400, epoch: 2 | loss: 0.7019267
	speed: 0.0767s/iter; left time: 1101.1977s
	iters: 500, epoch: 2 | loss: 0.4235242
	speed: 0.0735s/iter; left time: 1047.6038s
	iters: 600, epoch: 2 | loss: 0.4034302
	speed: 0.0745s/iter; left time: 1055.3530s
	iters: 700, epoch: 2 | loss: 0.3495967
	speed: 0.0750s/iter; left time: 1054.5856s
	iters: 800, epoch: 2 | loss: 0.6790119
	speed: 0.0738s/iter; left time: 1029.4775s
	iters: 900, epoch: 2 | loss: 0.7898614
	speed: 0.0719s/iter; left time: 996.2346s
	iters: 1000, epoch: 2 | loss: 0.5375298
	speed: 0.0747s/iter; left time: 1028.3295s
Epoch: 2 cost time: 79.70871043205261
Epoch: 2, Steps: 1054 | Train Loss: 0.5892740 Vali Loss: 0.2890468 Test Loss: 0.4005979
Validation loss decreased (0.303872 --> 0.289047).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4951227
	speed: 1.6961s/iter; left time: 23072.5767s
	iters: 200, epoch: 3 | loss: 0.6676022
	speed: 0.0764s/iter; left time: 1032.1190s
	iters: 300, epoch: 3 | loss: 0.3608778
	speed: 0.0742s/iter; left time: 994.3159s
	iters: 400, epoch: 3 | loss: 0.3164957
	speed: 0.0753s/iter; left time: 1001.1428s
	iters: 500, epoch: 3 | loss: 0.4960788
	speed: 0.0647s/iter; left time: 853.9785s
	iters: 600, epoch: 3 | loss: 0.6004891
	speed: 0.0637s/iter; left time: 835.0427s
	iters: 700, epoch: 3 | loss: 0.5884377
	speed: 0.0624s/iter; left time: 811.9901s
	iters: 800, epoch: 3 | loss: 0.5039953
	speed: 0.0639s/iter; left time: 824.5210s
	iters: 900, epoch: 3 | loss: 0.4634100
	speed: 0.0624s/iter; left time: 798.6333s
	iters: 1000, epoch: 3 | loss: 0.5548252
	speed: 0.0627s/iter; left time: 796.8485s
Epoch: 3 cost time: 72.13198375701904
Epoch: 3, Steps: 1054 | Train Loss: 0.5750583 Vali Loss: 0.2886815 Test Loss: 0.3962970
Validation loss decreased (0.289047 --> 0.288681).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5475264
	speed: 1.6901s/iter; left time: 21209.5685s
	iters: 200, epoch: 4 | loss: 0.3494095
	speed: 0.0717s/iter; left time: 891.9876s
	iters: 300, epoch: 4 | loss: 0.3245912
	speed: 0.0732s/iter; left time: 904.0705s
	iters: 400, epoch: 4 | loss: 0.5323390
	speed: 0.0725s/iter; left time: 888.0073s
	iters: 500, epoch: 4 | loss: 0.7025407
	speed: 0.0586s/iter; left time: 712.0402s
	iters: 600, epoch: 4 | loss: 0.6011636
	speed: 0.0622s/iter; left time: 749.3481s
	iters: 700, epoch: 4 | loss: 0.6749958
	speed: 0.0638s/iter; left time: 761.8216s
	iters: 800, epoch: 4 | loss: 0.6896955
	speed: 0.0637s/iter; left time: 754.5792s
	iters: 900, epoch: 4 | loss: 0.7963596
	speed: 0.0657s/iter; left time: 771.7181s
	iters: 1000, epoch: 4 | loss: 0.6956996
	speed: 0.0587s/iter; left time: 684.3059s
Epoch: 4 cost time: 69.61481595039368
Epoch: 4, Steps: 1054 | Train Loss: 0.5692930 Vali Loss: 0.2899843 Test Loss: 0.3948100
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4436487
	speed: 1.4707s/iter; left time: 16906.0399s
	iters: 200, epoch: 5 | loss: 0.9814097
	speed: 0.0632s/iter; left time: 720.0070s
	iters: 300, epoch: 5 | loss: 0.6697708
	speed: 0.0708s/iter; left time: 799.7564s
	iters: 400, epoch: 5 | loss: 0.8757187
	speed: 0.0715s/iter; left time: 800.2440s
	iters: 500, epoch: 5 | loss: 1.0092374
	speed: 0.0721s/iter; left time: 800.0024s
	iters: 600, epoch: 5 | loss: 0.6591213
	speed: 0.0710s/iter; left time: 780.7798s
	iters: 700, epoch: 5 | loss: 0.3073081
	speed: 0.0718s/iter; left time: 782.3940s
	iters: 800, epoch: 5 | loss: 0.6300487
	speed: 0.0699s/iter; left time: 754.4613s
	iters: 900, epoch: 5 | loss: 0.4324614
	speed: 0.0786s/iter; left time: 840.5746s
	iters: 1000, epoch: 5 | loss: 0.5821665
	speed: 0.0776s/iter; left time: 821.7678s
Epoch: 5 cost time: 75.67735886573792
Epoch: 5, Steps: 1054 | Train Loss: 0.5661580 Vali Loss: 0.2875400 Test Loss: 0.3940846
Validation loss decreased (0.288681 --> 0.287540).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.7233676
	speed: 1.5517s/iter; left time: 16200.8162s
	iters: 200, epoch: 6 | loss: 0.5061812
	speed: 0.0507s/iter; left time: 523.9427s
	iters: 300, epoch: 6 | loss: 0.2947045
	speed: 0.0572s/iter; left time: 585.3151s
	iters: 400, epoch: 6 | loss: 0.5389168
	speed: 0.0574s/iter; left time: 581.9430s
	iters: 500, epoch: 6 | loss: 0.5167814
	speed: 0.0561s/iter; left time: 563.3591s
	iters: 600, epoch: 6 | loss: 0.4181919
	speed: 0.0573s/iter; left time: 569.7739s
	iters: 700, epoch: 6 | loss: 0.6450250
	speed: 0.0587s/iter; left time: 577.5918s
	iters: 800, epoch: 6 | loss: 0.5966584
	speed: 0.0556s/iter; left time: 542.0324s
	iters: 900, epoch: 6 | loss: 0.1912905
	speed: 0.0574s/iter; left time: 553.4318s
	iters: 1000, epoch: 6 | loss: 0.7483673
	speed: 0.0584s/iter; left time: 557.5059s
Epoch: 6 cost time: 59.79444742202759
Epoch: 6, Steps: 1054 | Train Loss: 0.5626590 Vali Loss: 0.2915820 Test Loss: 0.3933206
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 1.4232305
	speed: 1.6065s/iter; left time: 15079.8938s
	iters: 200, epoch: 7 | loss: 0.7856137
	speed: 0.0706s/iter; left time: 655.4478s
	iters: 300, epoch: 7 | loss: 0.3422805
	speed: 0.0738s/iter; left time: 678.3400s
	iters: 400, epoch: 7 | loss: 0.9227130
	speed: 0.0748s/iter; left time: 679.8848s
	iters: 500, epoch: 7 | loss: 0.6051478
	speed: 0.0739s/iter; left time: 663.7959s
	iters: 600, epoch: 7 | loss: 0.6887507
	speed: 0.0760s/iter; left time: 675.7123s
	iters: 700, epoch: 7 | loss: 0.3547062
	speed: 0.0745s/iter; left time: 654.4070s
	iters: 800, epoch: 7 | loss: 0.3168630
	speed: 0.0744s/iter; left time: 646.0103s
	iters: 900, epoch: 7 | loss: 0.6462376
	speed: 0.0739s/iter; left time: 634.4855s
	iters: 1000, epoch: 7 | loss: 0.3911207
	speed: 0.0767s/iter; left time: 650.8233s
Epoch: 7 cost time: 78.14858818054199
Epoch: 7, Steps: 1054 | Train Loss: 0.5599104 Vali Loss: 0.2896158 Test Loss: 0.3910327
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6818959
	speed: 1.6187s/iter; left time: 13488.5662s
	iters: 200, epoch: 8 | loss: 0.3751672
	speed: 0.0695s/iter; left time: 572.5365s
	iters: 300, epoch: 8 | loss: 0.4154970
	speed: 0.0715s/iter; left time: 581.3598s
	iters: 400, epoch: 8 | loss: 0.6987317
	speed: 0.0741s/iter; left time: 595.0099s
	iters: 500, epoch: 8 | loss: 0.4610728
	speed: 0.0751s/iter; left time: 595.5275s
	iters: 600, epoch: 8 | loss: 0.6218913
	speed: 0.0759s/iter; left time: 594.5174s
	iters: 700, epoch: 8 | loss: 0.8916640
	speed: 0.0735s/iter; left time: 568.3222s
	iters: 800, epoch: 8 | loss: 0.9907818
	speed: 0.0766s/iter; left time: 584.5613s
	iters: 900, epoch: 8 | loss: 0.4258079
	speed: 0.0749s/iter; left time: 563.8943s
	iters: 1000, epoch: 8 | loss: 0.6392183
	speed: 0.0750s/iter; left time: 557.7401s
Epoch: 8 cost time: 78.65730571746826
Epoch: 8, Steps: 1054 | Train Loss: 0.5561268 Vali Loss: 0.2873454 Test Loss: 0.3904142
Validation loss decreased (0.287540 --> 0.287345).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3674169
	speed: 1.6211s/iter; left time: 11799.6300s
	iters: 200, epoch: 9 | loss: 0.4227421
	speed: 0.0733s/iter; left time: 526.0144s
	iters: 300, epoch: 9 | loss: 0.6332630
	speed: 0.0746s/iter; left time: 527.9947s
	iters: 400, epoch: 9 | loss: 0.2521330
	speed: 0.0707s/iter; left time: 493.4376s
	iters: 500, epoch: 9 | loss: 0.4216360
	speed: 0.0768s/iter; left time: 528.6090s
	iters: 600, epoch: 9 | loss: 0.3265859
	speed: 0.0778s/iter; left time: 527.6478s
	iters: 700, epoch: 9 | loss: 0.7727197
	speed: 0.0759s/iter; left time: 507.2192s
	iters: 800, epoch: 9 | loss: 0.3114444
	speed: 0.0753s/iter; left time: 495.5048s
	iters: 900, epoch: 9 | loss: 0.2891219
	speed: 0.0740s/iter; left time: 479.6245s
	iters: 1000, epoch: 9 | loss: 0.6698779
	speed: 0.0772s/iter; left time: 492.6430s
Epoch: 9 cost time: 79.48567962646484
Epoch: 9, Steps: 1054 | Train Loss: 0.5530989 Vali Loss: 0.2877723 Test Loss: 0.3891674
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5087911
	speed: 1.6184s/iter; left time: 10074.2972s
	iters: 200, epoch: 10 | loss: 0.4988980
	speed: 0.0739s/iter; left time: 452.9102s
	iters: 300, epoch: 10 | loss: 0.4697382
	speed: 0.0736s/iter; left time: 443.2490s
	iters: 400, epoch: 10 | loss: 1.1735103
	speed: 0.0738s/iter; left time: 437.0203s
	iters: 500, epoch: 10 | loss: 0.4005597
	speed: 0.0728s/iter; left time: 423.8274s
	iters: 600, epoch: 10 | loss: 0.6434822
	speed: 0.0765s/iter; left time: 438.0368s
	iters: 700, epoch: 10 | loss: 0.4492105
	speed: 0.0755s/iter; left time: 424.7998s
	iters: 800, epoch: 10 | loss: 0.5072472
	speed: 0.0753s/iter; left time: 416.1781s
	iters: 900, epoch: 10 | loss: 0.3096512
	speed: 0.0762s/iter; left time: 413.1413s
	iters: 1000, epoch: 10 | loss: 0.5053702
	speed: 0.0740s/iter; left time: 393.9344s
Epoch: 10 cost time: 79.08522701263428
Epoch: 10, Steps: 1054 | Train Loss: 0.5498593 Vali Loss: 0.2892890 Test Loss: 0.3896847
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3879811
	speed: 1.6245s/iter; left time: 8400.3086s
	iters: 200, epoch: 11 | loss: 0.5066176
	speed: 0.0731s/iter; left time: 370.6131s
	iters: 300, epoch: 11 | loss: 0.2780274
	speed: 0.0726s/iter; left time: 361.1331s
	iters: 400, epoch: 11 | loss: 0.5159394
	speed: 0.0734s/iter; left time: 357.3345s
	iters: 500, epoch: 11 | loss: 0.6690985
	speed: 0.0762s/iter; left time: 363.5066s
	iters: 600, epoch: 11 | loss: 0.4454843
	speed: 0.0771s/iter; left time: 360.0296s
	iters: 700, epoch: 11 | loss: 0.7602929
	speed: 0.0759s/iter; left time: 346.9153s
	iters: 800, epoch: 11 | loss: 1.0511336
	speed: 0.0762s/iter; left time: 340.6570s
	iters: 900, epoch: 11 | loss: 0.7098287
	speed: 0.0745s/iter; left time: 325.6495s
	iters: 1000, epoch: 11 | loss: 0.5935715
	speed: 0.0740s/iter; left time: 316.1072s
Epoch: 11 cost time: 79.02627635002136
Epoch: 11, Steps: 1054 | Train Loss: 0.5470747 Vali Loss: 0.2880974 Test Loss: 0.3890219
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.9539812
	speed: 1.6129s/iter; left time: 6640.2265s
	iters: 200, epoch: 12 | loss: 0.7449190
	speed: 0.0734s/iter; left time: 294.8523s
	iters: 300, epoch: 12 | loss: 0.5289993
	speed: 0.0708s/iter; left time: 277.3761s
	iters: 400, epoch: 12 | loss: 1.1819229
	speed: 0.0725s/iter; left time: 276.9180s
	iters: 500, epoch: 12 | loss: 0.5081002
	speed: 0.0719s/iter; left time: 267.2594s
	iters: 600, epoch: 12 | loss: 0.8165423
	speed: 0.0778s/iter; left time: 281.4559s
	iters: 700, epoch: 12 | loss: 0.7248807
	speed: 0.0765s/iter; left time: 268.9594s
	iters: 800, epoch: 12 | loss: 0.3166528
	speed: 0.0774s/iter; left time: 264.4926s
	iters: 900, epoch: 12 | loss: 0.5284879
	speed: 0.0742s/iter; left time: 246.0390s
	iters: 1000, epoch: 12 | loss: 0.4003244
	speed: 0.0752s/iter; left time: 241.8602s
Epoch: 12 cost time: 78.51123714447021
Epoch: 12, Steps: 1054 | Train Loss: 0.5436449 Vali Loss: 0.2874542 Test Loss: 0.3881063
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5651441
	speed: 1.6115s/iter; left time: 4936.1677s
	iters: 200, epoch: 13 | loss: 0.5527545
	speed: 0.0723s/iter; left time: 214.2164s
	iters: 300, epoch: 13 | loss: 0.8546147
	speed: 0.0711s/iter; left time: 203.5463s
	iters: 400, epoch: 13 | loss: 0.7871882
	speed: 0.0741s/iter; left time: 204.6915s
	iters: 500, epoch: 13 | loss: 0.3091623
	speed: 0.0733s/iter; left time: 195.1562s
	iters: 600, epoch: 13 | loss: 0.8440581
	speed: 0.0747s/iter; left time: 191.5528s
	iters: 700, epoch: 13 | loss: 0.7524468
	speed: 0.0771s/iter; left time: 189.8463s
	iters: 800, epoch: 13 | loss: 0.4218293
	speed: 0.0764s/iter; left time: 180.6349s
	iters: 900, epoch: 13 | loss: 0.8245656
	speed: 0.0751s/iter; left time: 169.9572s
	iters: 1000, epoch: 13 | loss: 0.5244151
	speed: 0.0770s/iter; left time: 166.5932s
Epoch: 13 cost time: 79.05416893959045
Epoch: 13, Steps: 1054 | Train Loss: 0.5420691 Vali Loss: 0.2861899 Test Loss: 0.3883409
Validation loss decreased (0.287345 --> 0.286190).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.3128658
	speed: 1.6272s/iter; left time: 3269.1353s
	iters: 200, epoch: 14 | loss: 0.4910534
	speed: 0.0725s/iter; left time: 138.4575s
	iters: 300, epoch: 14 | loss: 0.4263234
	speed: 0.0740s/iter; left time: 133.8173s
	iters: 400, epoch: 14 | loss: 0.2569322
	speed: 0.0737s/iter; left time: 125.9972s
	iters: 500, epoch: 14 | loss: 0.7822791
	speed: 0.0737s/iter; left time: 118.5990s
	iters: 600, epoch: 14 | loss: 0.7027139
	speed: 0.0732s/iter; left time: 110.4266s
	iters: 700, epoch: 14 | loss: 0.3527187
	speed: 0.0782s/iter; left time: 110.1917s
	iters: 800, epoch: 14 | loss: 0.3380617
	speed: 0.0779s/iter; left time: 102.0073s
	iters: 900, epoch: 14 | loss: 0.4821961
	speed: 0.0758s/iter; left time: 91.6146s
	iters: 1000, epoch: 14 | loss: 0.5700900
	speed: 0.0777s/iter; left time: 86.1653s
Epoch: 14 cost time: 79.30571484565735
Epoch: 14, Steps: 1054 | Train Loss: 0.5402851 Vali Loss: 0.2863312 Test Loss: 0.3885397
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.3264940
	speed: 1.6111s/iter; left time: 1538.5530s
	iters: 200, epoch: 15 | loss: 0.5321317
	speed: 0.0726s/iter; left time: 62.1028s
	iters: 300, epoch: 15 | loss: 0.7707291
	speed: 0.0719s/iter; left time: 54.2741s
	iters: 400, epoch: 15 | loss: 1.2507364
	speed: 0.0733s/iter; left time: 48.0084s
	iters: 500, epoch: 15 | loss: 0.4487522
	speed: 0.0752s/iter; left time: 41.7420s
	iters: 600, epoch: 15 | loss: 0.7171091
	speed: 0.0730s/iter; left time: 33.1936s
	iters: 700, epoch: 15 | loss: 0.5449499
	speed: 0.0740s/iter; left time: 26.2866s
	iters: 800, epoch: 15 | loss: 0.4939409
	speed: 0.0778s/iter; left time: 19.8346s
	iters: 900, epoch: 15 | loss: 0.4215722
	speed: 0.0779s/iter; left time: 12.0741s
	iters: 1000, epoch: 15 | loss: 0.4334187
	speed: 0.0762s/iter; left time: 4.1886s
Epoch: 15 cost time: 79.14171719551086
Epoch: 15, Steps: 1054 | Train Loss: 0.5381794 Vali Loss: 0.2876814 Test Loss: 0.3897312
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
>>>>>>>testing : ETTm2_96_720_MLPAer_ETTm2_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.38834041357040405, mae:0.38964977860450745, rse:0.5006964206695557
