Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='crop_96_96', model='MLPAer', data='custom', root_path='./dataset/crop', data_path='crop.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.05, head_dropout=0.3, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=1024, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=3, learning_rate=0.001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=8, t_ff=256, c_dropout=0.0, t_dropout=0.1, embed_dropout=0.1, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : crop_96_96_MLPAer_custom_ftM_sl96_ll48_pl96_dm1024_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6048
val 798
test 1687
Epoch: 1 cost time: 0.9367256164550781
Epoch: 1, Steps: 47 | Train Loss: 1.0382354 Vali Loss: 1.0921367 Test Loss: 0.6935371
Validation loss decreased (inf --> 1.092137).  Saving model ...
Updating learning rate to 0.001
Epoch: 2 cost time: 0.685016393661499
Epoch: 2, Steps: 47 | Train Loss: 0.7895338 Vali Loss: 0.8594289 Test Loss: 0.5326902
Validation loss decreased (1.092137 --> 0.859429).  Saving model ...
Updating learning rate to 0.001
Epoch: 3 cost time: 0.6901617050170898
Epoch: 3, Steps: 47 | Train Loss: 0.7047353 Vali Loss: 0.8244646 Test Loss: 0.5160458
Validation loss decreased (0.859429 --> 0.824465).  Saving model ...
Updating learning rate to 0.001
Epoch: 4 cost time: 0.6759741306304932
Epoch: 4, Steps: 47 | Train Loss: 0.6631025 Vali Loss: 0.7858291 Test Loss: 0.4796616
Validation loss decreased (0.824465 --> 0.785829).  Saving model ...
Updating learning rate to 0.0009000000000000001
Epoch: 5 cost time: 0.7322776317596436
Epoch: 5, Steps: 47 | Train Loss: 0.6322203 Vali Loss: 0.7657745 Test Loss: 0.4713210
Validation loss decreased (0.785829 --> 0.765774).  Saving model ...
Updating learning rate to 0.0008100000000000001
Epoch: 6 cost time: 0.6758308410644531
Epoch: 6, Steps: 47 | Train Loss: 0.6168929 Vali Loss: 0.7743443 Test Loss: 0.4610575
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0007290000000000002
Epoch: 7 cost time: 0.681833028793335
Epoch: 7, Steps: 47 | Train Loss: 0.6040660 Vali Loss: 0.7523337 Test Loss: 0.4628067
Validation loss decreased (0.765774 --> 0.752334).  Saving model ...
Updating learning rate to 0.0006561000000000001
Epoch: 8 cost time: 0.7357335090637207
Epoch: 8, Steps: 47 | Train Loss: 0.5950537 Vali Loss: 0.7567806 Test Loss: 0.4564542
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00059049
Epoch: 9 cost time: 0.6624574661254883
Epoch: 9, Steps: 47 | Train Loss: 0.5851196 Vali Loss: 0.7592878 Test Loss: 0.4571548
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000531441
Epoch: 10 cost time: 0.7158265113830566
Epoch: 10, Steps: 47 | Train Loss: 0.5791444 Vali Loss: 0.7634477 Test Loss: 0.4528915
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : crop_96_96_MLPAer_custom_ftM_sl96_ll48_pl96_dm1024_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1687
find shape (1664, 96, 8) (1664, 96, 8)
mse:0.46280670166015625, mae:0.48921507596969604, nse:0.7128280401229858, mape:1.7892911434173584
