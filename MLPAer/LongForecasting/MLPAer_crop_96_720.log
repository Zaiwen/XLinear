Args in experiment:
Namespace(random_seed=2025, is_training=1, model_id='crop_96_720', model='MLPAer', data='custom', root_path='./dataset/crop', data_path='crop.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, fc_dropout=0.05, head_dropout=0.4, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=100, learning_rate=0.001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, c_ff=8, t_ff=256, c_dropout=0.1, t_dropout=0.1, embed_dropout=0.1, head_type='prediction', usenorm=1, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : crop_96_720_MLPAer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5424
val 174
test 1063
Epoch: 1 cost time: 1.108708143234253
Epoch: 1, Steps: 42 | Train Loss: 1.3975055 Vali Loss: 1.1079928 Test Loss: 0.9289271
Validation loss decreased (inf --> 1.107993).  Saving model ...
Updating learning rate to 0.001
Epoch: 2 cost time: 1.0349369049072266
Epoch: 2, Steps: 42 | Train Loss: 1.2010392 Vali Loss: 0.8378918 Test Loss: 0.8355688
Validation loss decreased (1.107993 --> 0.837892).  Saving model ...
Updating learning rate to 0.001
Epoch: 3 cost time: 1.039780616760254
Epoch: 3, Steps: 42 | Train Loss: 1.1385957 Vali Loss: 0.8598477 Test Loss: 0.8119435
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.001
Epoch: 4 cost time: 1.0134544372558594
Epoch: 4, Steps: 42 | Train Loss: 1.1260369 Vali Loss: 0.8714682 Test Loss: 0.8005295
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0009000000000000001
Epoch: 5 cost time: 0.9147999286651611
Epoch: 5, Steps: 42 | Train Loss: 1.1161832 Vali Loss: 0.8168980 Test Loss: 0.7921519
Validation loss decreased (0.837892 --> 0.816898).  Saving model ...
Updating learning rate to 0.0008100000000000001
Epoch: 6 cost time: 0.9306735992431641
Epoch: 6, Steps: 42 | Train Loss: 1.1069862 Vali Loss: 0.8258318 Test Loss: 0.7869706
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0007290000000000002
Epoch: 7 cost time: 0.9011824131011963
Epoch: 7, Steps: 42 | Train Loss: 1.0979755 Vali Loss: 0.8561163 Test Loss: 0.7801760
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0006561000000000001
Epoch: 8 cost time: 1.0013000965118408
Epoch: 8, Steps: 42 | Train Loss: 1.0859516 Vali Loss: 0.8051826 Test Loss: 0.7776943
Validation loss decreased (0.816898 --> 0.805183).  Saving model ...
Updating learning rate to 0.00059049
Epoch: 9 cost time: 0.9583601951599121
Epoch: 9, Steps: 42 | Train Loss: 1.0756120 Vali Loss: 0.8160329 Test Loss: 0.7744774
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.000531441
Epoch: 10 cost time: 0.9478514194488525
Epoch: 10, Steps: 42 | Train Loss: 1.0662076 Vali Loss: 0.8000427 Test Loss: 0.7765361
Validation loss decreased (0.805183 --> 0.800043).  Saving model ...
Updating learning rate to 0.0004782969000000001
Epoch: 11 cost time: 0.9201664924621582
Epoch: 11, Steps: 42 | Train Loss: 1.0559057 Vali Loss: 0.8126644 Test Loss: 0.7794440
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004304672100000001
Epoch: 12 cost time: 0.8453953266143799
Epoch: 12, Steps: 42 | Train Loss: 1.0471180 Vali Loss: 0.8016177 Test Loss: 0.7835697
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0003874204890000001
Epoch: 13 cost time: 0.8497681617736816
Epoch: 13, Steps: 42 | Train Loss: 1.0407229 Vali Loss: 0.8033937 Test Loss: 0.7853029
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0003486784401000001
Epoch: 14 cost time: 0.8103137016296387
Epoch: 14, Steps: 42 | Train Loss: 1.0356113 Vali Loss: 0.8317103 Test Loss: 0.7897457
EarlyStopping counter: 4 out of 100
Updating learning rate to 0.0003138105960900001
Epoch: 15 cost time: 0.8496026992797852
Epoch: 15, Steps: 42 | Train Loss: 1.0290079 Vali Loss: 0.7996314 Test Loss: 0.7970179
Validation loss decreased (0.800043 --> 0.799631).  Saving model ...
Updating learning rate to 0.0002824295364810001
Epoch: 16 cost time: 0.9135951995849609
Epoch: 16, Steps: 42 | Train Loss: 1.0252565 Vali Loss: 0.8091518 Test Loss: 0.7966129
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002541865828329001
Epoch: 17 cost time: 0.9110922813415527
Epoch: 17, Steps: 42 | Train Loss: 1.0197140 Vali Loss: 0.8371955 Test Loss: 0.8014625
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0002287679245496101
Epoch: 18 cost time: 0.83426833152771
Epoch: 18, Steps: 42 | Train Loss: 1.0191364 Vali Loss: 0.8136197 Test Loss: 0.8038236
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0002058911320946491
Epoch: 19 cost time: 0.846904993057251
Epoch: 19, Steps: 42 | Train Loss: 1.0147276 Vali Loss: 0.7912468 Test Loss: 0.8037804
Validation loss decreased (0.799631 --> 0.791247).  Saving model ...
Updating learning rate to 0.00018530201888518417
Epoch: 20 cost time: 0.8786811828613281
Epoch: 20, Steps: 42 | Train Loss: 1.0121154 Vali Loss: 0.8086510 Test Loss: 0.8014837
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00016677181699666576
Epoch: 21 cost time: 0.854804515838623
Epoch: 21, Steps: 42 | Train Loss: 1.0089262 Vali Loss: 0.7952634 Test Loss: 0.8028549
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00015009463529699917
Epoch: 22 cost time: 0.8288183212280273
Epoch: 22, Steps: 42 | Train Loss: 1.0054431 Vali Loss: 0.8065671 Test Loss: 0.8043502
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.0001350851717672993
Epoch: 23 cost time: 0.9042508602142334
Epoch: 23, Steps: 42 | Train Loss: 1.0033526 Vali Loss: 0.7433200 Test Loss: 0.8042454
Validation loss decreased (0.791247 --> 0.743320).  Saving model ...
Updating learning rate to 0.00012157665459056935
Epoch: 24 cost time: 0.8418292999267578
Epoch: 24, Steps: 42 | Train Loss: 1.0012256 Vali Loss: 0.8156548 Test Loss: 0.8061700
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010941898913151242
Epoch: 25 cost time: 1.1779241561889648
Epoch: 25, Steps: 42 | Train Loss: 0.9992923 Vali Loss: 0.7841164 Test Loss: 0.8069352
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-05
Epoch: 26 cost time: 0.9244992733001709
Epoch: 26, Steps: 42 | Train Loss: 0.9960687 Vali Loss: 0.8255567 Test Loss: 0.8056055
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652506e-05
Epoch: 27 cost time: 0.8760333061218262
Epoch: 27, Steps: 42 | Train Loss: 0.9963339 Vali Loss: 0.7997947 Test Loss: 0.8015862
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687256e-05
Epoch: 28 cost time: 0.8510630130767822
Epoch: 28, Steps: 42 | Train Loss: 0.9939928 Vali Loss: 0.7933001 Test Loss: 0.8040738
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.17897987691853e-05
Epoch: 29 cost time: 0.8673160076141357
Epoch: 29, Steps: 42 | Train Loss: 0.9924149 Vali Loss: 0.7862124 Test Loss: 0.8030000
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.461081889226677e-05
Epoch: 30 cost time: 0.88519287109375
Epoch: 30, Steps: 42 | Train Loss: 0.9927761 Vali Loss: 0.7622642 Test Loss: 0.8051857
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040094e-05
>>>>>>>testing : crop_96_720_MLPAer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1063
find shape (1024, 720, 8) (1024, 720, 8)
mse:0.8042450547218323, mae:0.6993181705474854, nse:0.48490291833877563, mape:2.3657236099243164
